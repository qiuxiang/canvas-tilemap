"use strict";(()=>{function mn(r,e,t){return Math.max(e,Math.min(r,t))}var O={toVector(r,e){return r===void 0&&(r=e),Array.isArray(r)?r:[r,r]},add(r,e){return[r[0]+e[0],r[1]+e[1]]},sub(r,e){return[r[0]-e[0],r[1]-e[1]]},addTo(r,e){r[0]+=e[0],r[1]+=e[1]},subTo(r,e){r[0]-=e[0],r[1]-=e[1]}};function kt(r,e,t){return e===0||Math.abs(e)===1/0?Math.pow(r,t*5):r*e*t/(e+t*r)}function jt(r,e,t,n=.15){return n===0?mn(r,e,t):r<e?-kt(e-r,t-e,n)+e:r>t?+kt(r-t,t-e,n)+t:r}function Rt(r,[e,t],[n,s]){let[[i,o],[a,c]]=r;return[jt(e,i,o,n),jt(t,a,c,s)]}function dn(r,e){if(typeof r!="object"||r===null)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function gn(r){var e=dn(r,"string");return typeof e=="symbol"?e:String(e)}function I(r,e,t){return e=gn(e),e in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function Bt(r,e){var t=Object.keys(r);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(r);e&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(r,s).enumerable})),t.push.apply(t,n)}return t}function E(r){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?Bt(Object(t),!0).forEach(function(n){I(r,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(t)):Bt(Object(t)).forEach(function(n){Object.defineProperty(r,n,Object.getOwnPropertyDescriptor(t,n))})}return r}var Kt={pointer:{start:"down",change:"move",end:"up"},mouse:{start:"down",change:"move",end:"up"},touch:{start:"start",change:"move",end:"end"},gesture:{start:"start",change:"change",end:"end"}};function $t(r){return r?r[0].toUpperCase()+r.slice(1):""}var yn=["enter","leave"];function vn(r=!1,e){return r&&!yn.includes(e)}function Wt(r,e="",t=!1){let n=Kt[r],s=n&&n[e]||e;return"on"+$t(r)+$t(s)+(vn(t,s)?"Capture":"")}var bn=["gotpointercapture","lostpointercapture"];function qt(r){let e=r.substring(2).toLowerCase(),t=!!~e.indexOf("passive");t&&(e=e.replace("passive",""));let n=bn.includes(e)?"capturecapture":"capture",s=!!~e.indexOf(n);return s&&(e=e.replace("capture","")),{device:e,capture:s,passive:t}}function Zt(r,e=""){let t=Kt[r],n=t&&t[e]||e;return r+n}function ae(r){return"touches"in r}function Xt(r){return ae(r)?"touch":"pointerType"in r?r.pointerType:"mouse"}function _n(r){return Array.from(r.touches).filter(e=>{var t,n;return e.target===r.currentTarget||((t=r.currentTarget)===null||t===void 0||(n=t.contains)===null||n===void 0?void 0:n.call(t,e.target))})}function wn(r){return r.type==="touchend"||r.type==="touchcancel"?r.changedTouches:r.targetTouches}function Qt(r){return ae(r)?wn(r)[0]:r}function Je(r,e){try{let t=e.clientX-r.clientX,n=e.clientY-r.clientY,s=(e.clientX+r.clientX)/2,i=(e.clientY+r.clientY)/2,o=Math.hypot(t,n);return{angle:-(Math.atan2(t,n)*180)/Math.PI,distance:o,origin:[s,i]}}catch{}return null}function Jt(r){return _n(r).map(e=>e.identifier)}function Nt(r,e){let[t,n]=Array.from(r.touches).filter(s=>e.includes(s.identifier));return Je(t,n)}function Qe(r){let e=Qt(r);return ae(r)?e.identifier:e.pointerId}function W(r){let e=Qt(r);return[e.clientX,e.clientY]}var Ut=40,zt=800;function er(r){let{deltaX:e,deltaY:t,deltaMode:n}=r;return n===1?(e*=Ut,t*=Ut):n===2&&(e*=zt,t*=zt),[e,t]}function xn(r){var e,t;let{scrollX:n,scrollY:s,scrollLeft:i,scrollTop:o}=r.currentTarget;return[(e=n??i)!==null&&e!==void 0?e:0,(t=s??o)!==null&&t!==void 0?t:0]}function Sn(r){let e={};if("buttons"in r&&(e.buttons=r.buttons),"shiftKey"in r){let{shiftKey:t,altKey:n,metaKey:s,ctrlKey:i}=r;Object.assign(e,{shiftKey:t,altKey:n,metaKey:s,ctrlKey:i})}return e}function xe(r,...e){return typeof r=="function"?r(...e):r}function On(){}function tr(...r){return r.length===0?On:r.length===1?r[0]:function(){let e;for(let t of r)e=t.apply(this,arguments)||e;return e}}function Ft(r,e){return Object.assign({},e,r||{})}var Tn=32,Se=class{constructor(e,t,n){this.ctrl=e,this.args=t,this.key=n,this.state||(this.state={},this.computeValues([0,0]),this.computeInitial(),this.init&&this.init(),this.reset())}get state(){return this.ctrl.state[this.key]}set state(e){this.ctrl.state[this.key]=e}get shared(){return this.ctrl.state.shared}get eventStore(){return this.ctrl.gestureEventStores[this.key]}get timeoutStore(){return this.ctrl.gestureTimeoutStores[this.key]}get config(){return this.ctrl.config[this.key]}get sharedConfig(){return this.ctrl.config.shared}get handler(){return this.ctrl.handlers[this.key]}reset(){let{state:e,shared:t,ingKey:n,args:s}=this;t[n]=e._active=e.active=e._blocked=e._force=!1,e._step=[!1,!1],e.intentional=!1,e._movement=[0,0],e._distance=[0,0],e._direction=[0,0],e._delta=[0,0],e._bounds=[[-1/0,1/0],[-1/0,1/0]],e.args=s,e.axis=void 0,e.memo=void 0,e.elapsedTime=e.timeDelta=0,e.direction=[0,0],e.distance=[0,0],e.overflow=[0,0],e._movementBound=[!1,!1],e.velocity=[0,0],e.movement=[0,0],e.delta=[0,0],e.timeStamp=0}start(e){let t=this.state,n=this.config;t._active||(this.reset(),this.computeInitial(),t._active=!0,t.target=e.target,t.currentTarget=e.currentTarget,t.lastOffset=n.from?xe(n.from,t):t.offset,t.offset=t.lastOffset,t.startTime=t.timeStamp=e.timeStamp)}computeValues(e){let t=this.state;t._values=e,t.values=this.config.transform(e)}computeInitial(){let e=this.state;e._initial=e._values,e.initial=e.values}compute(e){let{state:t,config:n,shared:s}=this;t.args=this.args;let i=0;if(e&&(t.event=e,n.preventDefault&&e.cancelable&&t.event.preventDefault(),t.type=e.type,s.touches=this.ctrl.pointerIds.size||this.ctrl.touchIds.size,s.locked=!!document.pointerLockElement,Object.assign(s,Sn(e)),s.down=s.pressed=s.buttons%2===1||s.touches>0,i=e.timeStamp-t.timeStamp,t.timeStamp=e.timeStamp,t.elapsedTime=t.timeStamp-t.startTime),t._active){let S=t._delta.map(Math.abs);O.addTo(t._distance,S)}this.axisIntent&&this.axisIntent(e);let[o,a]=t._movement,[c,u]=n.threshold,{_step:l,values:p}=t;if(n.hasCustomTransform?(l[0]===!1&&(l[0]=Math.abs(o)>=c&&p[0]),l[1]===!1&&(l[1]=Math.abs(a)>=u&&p[1])):(l[0]===!1&&(l[0]=Math.abs(o)>=c&&Math.sign(o)*c),l[1]===!1&&(l[1]=Math.abs(a)>=u&&Math.sign(a)*u)),t.intentional=l[0]!==!1||l[1]!==!1,!t.intentional)return;let d=[0,0];if(n.hasCustomTransform){let[S,M]=p;d[0]=l[0]!==!1?S-l[0]:0,d[1]=l[1]!==!1?M-l[1]:0}else d[0]=l[0]!==!1?o-l[0]:0,d[1]=l[1]!==!1?a-l[1]:0;this.restrictToAxis&&!t._blocked&&this.restrictToAxis(d);let b=t.offset,g=t._active&&!t._blocked||t.active;g&&(t.first=t._active&&!t.active,t.last=!t._active&&t.active,t.active=s[this.ingKey]=t._active,e&&(t.first&&("bounds"in n&&(t._bounds=xe(n.bounds,t)),this.setup&&this.setup()),t.movement=d,this.computeOffset()));let[v,_]=t.offset,[[m,f],[h,y]]=t._bounds;t.overflow=[v<m?-1:v>f?1:0,_<h?-1:_>y?1:0],t._movementBound[0]=t.overflow[0]?t._movementBound[0]===!1?t._movement[0]:t._movementBound[0]:!1,t._movementBound[1]=t.overflow[1]?t._movementBound[1]===!1?t._movement[1]:t._movementBound[1]:!1;let w=t._active?n.rubberband||[0,0]:[0,0];if(t.offset=Rt(t._bounds,t.offset,w),t.delta=O.sub(t.offset,b),this.computeMovement(),g&&(!t.last||i>Tn)){t.delta=O.sub(t.offset,b);let S=t.delta.map(Math.abs);O.addTo(t.distance,S),t.direction=t.delta.map(Math.sign),t._direction=t._delta.map(Math.sign),!t.first&&i>0&&(t.velocity=[S[0]/i,S[1]/i],t.timeDelta=i)}}emit(){let e=this.state,t=this.shared,n=this.config;if(e._active||this.clean(),(e._blocked||!e.intentional)&&!e._force&&!n.triggerAllEvents)return;let s=this.handler(E(E(E({},t),e),{},{[this.aliasKey]:e.values}));s!==void 0&&(e.memo=s)}clean(){this.eventStore.clean(),this.timeoutStore.clean()}};function En([r,e],t){let n=Math.abs(r),s=Math.abs(e);if(n>s&&n>t)return"x";if(s>n&&s>t)return"y"}var V=class extends Se{constructor(...e){super(...e),I(this,"aliasKey","xy")}reset(){super.reset(),this.state.axis=void 0}init(){this.state.offset=[0,0],this.state.lastOffset=[0,0]}computeOffset(){this.state.offset=O.add(this.state.lastOffset,this.state.movement)}computeMovement(){this.state.movement=O.sub(this.state.offset,this.state.lastOffset)}axisIntent(e){let t=this.state,n=this.config;if(!t.axis&&e){let s=typeof n.axisThreshold=="object"?n.axisThreshold[Xt(e)]:n.axisThreshold;t.axis=En(t._movement,s)}t._blocked=(n.lockDirection||!!n.axis)&&!t.axis||!!n.axis&&n.axis!==t.axis}restrictToAxis(e){if(this.config.axis||this.config.lockDirection)switch(this.state.axis){case"x":e[1]=0;break;case"y":e[0]=0;break}}},Mn=r=>r,Vt=.15,rr={enabled(r=!0){return r},eventOptions(r,e,t){return E(E({},t.shared.eventOptions),r)},preventDefault(r=!1){return r},triggerAllEvents(r=!1){return r},rubberband(r=0){switch(r){case!0:return[Vt,Vt];case!1:return[0,0];default:return O.toVector(r)}},from(r){if(typeof r=="function")return r;if(r!=null)return O.toVector(r)},transform(r,e,t){let n=r||t.shared.transform;return this.hasCustomTransform=!!n,n||Mn},threshold(r){return O.toVector(r,0)}},In=0,G=E(E({},rr),{},{axis(r,e,{axis:t}){if(this.lockDirection=t==="lock",!this.lockDirection)return t},axisThreshold(r=In){return r},bounds(r={}){if(typeof r=="function")return i=>G.bounds(r(i));if("current"in r)return()=>r.current;if(typeof HTMLElement=="function"&&r instanceof HTMLElement)return r;let{left:e=-1/0,right:t=1/0,top:n=-1/0,bottom:s=1/0}=r;return[[e,t],[n,s]]}}),Gt={ArrowRight:(r,e=1)=>[r*e,0],ArrowLeft:(r,e=1)=>[-1*r*e,0],ArrowUp:(r,e=1)=>[0,-1*r*e],ArrowDown:(r,e=1)=>[0,r*e]},et=class extends V{constructor(...e){super(...e),I(this,"ingKey","dragging")}reset(){super.reset();let e=this.state;e._pointerId=void 0,e._pointerActive=!1,e._keyboardActive=!1,e._preventScroll=!1,e._delayed=!1,e.swipe=[0,0],e.tap=!1,e.canceled=!1,e.cancel=this.cancel.bind(this)}setup(){let e=this.state;if(e._bounds instanceof HTMLElement){let t=e._bounds.getBoundingClientRect(),n=e.currentTarget.getBoundingClientRect(),s={left:t.left-n.left+e.offset[0],right:t.right-n.right+e.offset[0],top:t.top-n.top+e.offset[1],bottom:t.bottom-n.bottom+e.offset[1]};e._bounds=G.bounds(s)}}cancel(){let e=this.state;e.canceled||(e.canceled=!0,e._active=!1,setTimeout(()=>{this.compute(),this.emit()},0))}setActive(){this.state._active=this.state._pointerActive||this.state._keyboardActive}clean(){this.pointerClean(),this.state._pointerActive=!1,this.state._keyboardActive=!1,super.clean()}pointerDown(e){let t=this.config,n=this.state;if(e.buttons!=null&&(Array.isArray(t.pointerButtons)?!t.pointerButtons.includes(e.buttons):t.pointerButtons!==-1&&t.pointerButtons!==e.buttons))return;let s=this.ctrl.setEventIds(e);t.pointerCapture&&e.target.setPointerCapture(e.pointerId),!(s&&s.size>1&&n._pointerActive)&&(this.start(e),this.setupPointer(e),n._pointerId=Qe(e),n._pointerActive=!0,this.computeValues(W(e)),this.computeInitial(),t.preventScrollAxis&&Xt(e)!=="mouse"?(n._active=!1,this.setupScrollPrevention(e)):t.delay>0?(this.setupDelayTrigger(e),t.triggerAllEvents&&(this.compute(e),this.emit())):this.startPointerDrag(e))}startPointerDrag(e){let t=this.state;t._active=!0,t._preventScroll=!0,t._delayed=!1,this.compute(e),this.emit()}pointerMove(e){let t=this.state,n=this.config;if(!t._pointerActive||t.type===e.type&&e.timeStamp===t.timeStamp)return;let s=Qe(e);if(t._pointerId!==void 0&&s!==t._pointerId)return;let i=W(e);if(document.pointerLockElement===e.target?t._delta=[e.movementX,e.movementY]:(t._delta=O.sub(i,t._values),this.computeValues(i)),O.addTo(t._movement,t._delta),this.compute(e),t._delayed&&t.intentional){this.timeoutStore.remove("dragDelay"),t.active=!1,this.startPointerDrag(e);return}if(n.preventScrollAxis&&!t._preventScroll)if(t.axis)if(t.axis===n.preventScrollAxis||n.preventScrollAxis==="xy"){t._active=!1,this.clean();return}else{this.timeoutStore.remove("startPointerDrag"),this.startPointerDrag(e);return}else return;this.emit()}pointerUp(e){this.ctrl.setEventIds(e);try{this.config.pointerCapture&&e.target.hasPointerCapture(e.pointerId)&&e.target.releasePointerCapture(e.pointerId)}catch{}let t=this.state,n=this.config;if(!t._active||!t._pointerActive)return;let s=Qe(e);if(t._pointerId!==void 0&&s!==t._pointerId)return;this.state._pointerActive=!1,this.setActive(),this.compute(e);let[i,o]=t._distance;if(t.tap=i<=n.tapsThreshold&&o<=n.tapsThreshold,t.tap&&n.filterTaps)t._force=!0;else{let[a,c]=t._delta,[u,l]=t._movement,[p,d]=n.swipe.velocity,[b,g]=n.swipe.distance,v=n.swipe.duration;if(t.elapsedTime<v){let _=Math.abs(a/t.timeDelta),m=Math.abs(c/t.timeDelta);_>p&&Math.abs(u)>b&&(t.swipe[0]=Math.sign(a)),m>d&&Math.abs(l)>g&&(t.swipe[1]=Math.sign(c))}}this.emit()}pointerClick(e){!this.state.tap&&e.detail>0&&(e.preventDefault(),e.stopPropagation())}setupPointer(e){let t=this.config,n=t.device;if(!1)try{}catch(s){}t.pointerLock&&e.currentTarget.requestPointerLock(),t.pointerCapture||(this.eventStore.add(this.sharedConfig.window,n,"change",this.pointerMove.bind(this)),this.eventStore.add(this.sharedConfig.window,n,"end",this.pointerUp.bind(this)),this.eventStore.add(this.sharedConfig.window,n,"cancel",this.pointerUp.bind(this)))}pointerClean(){this.config.pointerLock&&document.pointerLockElement===this.state.currentTarget&&document.exitPointerLock()}preventScroll(e){this.state._preventScroll&&e.cancelable&&e.preventDefault()}setupScrollPrevention(e){this.state._preventScroll=!1,Ln(e);let t=this.eventStore.add(this.sharedConfig.window,"touch","change",this.preventScroll.bind(this),{passive:!1});this.eventStore.add(this.sharedConfig.window,"touch","end",t),this.eventStore.add(this.sharedConfig.window,"touch","cancel",t),this.timeoutStore.add("startPointerDrag",this.startPointerDrag.bind(this),this.config.preventScrollDelay,e)}setupDelayTrigger(e){this.state._delayed=!0,this.timeoutStore.add("dragDelay",()=>{this.state._step=[0,0],this.startPointerDrag(e)},this.config.delay)}keyDown(e){let t=Gt[e.key];if(t){let n=this.state,s=e.shiftKey?10:e.altKey?.1:1;this.start(e),n._delta=t(this.config.keyboardDisplacement,s),n._keyboardActive=!0,O.addTo(n._movement,n._delta),this.compute(e),this.emit()}}keyUp(e){e.key in Gt&&(this.state._keyboardActive=!1,this.setActive(),this.compute(e),this.emit())}bind(e){let t=this.config.device;e(t,"start",this.pointerDown.bind(this)),this.config.pointerCapture&&(e(t,"change",this.pointerMove.bind(this)),e(t,"end",this.pointerUp.bind(this)),e(t,"cancel",this.pointerUp.bind(this)),e("lostPointerCapture","",this.pointerUp.bind(this))),this.config.keys&&(e("key","down",this.keyDown.bind(this)),e("key","up",this.keyUp.bind(this))),this.config.filterTaps&&e("click","",this.pointerClick.bind(this),{capture:!0,passive:!1})}};function Ln(r){"persist"in r&&typeof r.persist=="function"&&r.persist()}var ce=typeof window<"u"&&window.document&&window.document.createElement;function An(){return ce&&"ontouchstart"in window}function Ht(){return An()||ce&&window.navigator.maxTouchPoints>1}function Dn(){return ce&&"onpointerdown"in window}function Pn(){return ce&&"exitPointerLock"in window.document}function Cn(){try{return"constructor"in GestureEvent}catch{return!1}}var L={isBrowser:ce,gesture:Cn(),touch:Ht(),touchscreen:Ht(),pointer:Dn(),pointerLock:Pn()},kn=250,jn=180,Rn=.5,Bn=50,$n=250,Nn=10,Yt={mouse:0,touch:0,pen:8},Un=E(E({},G),{},{device(r,e,{pointer:{touch:t=!1,lock:n=!1,mouse:s=!1}={}}){return this.pointerLock=n&&L.pointerLock,L.touch&&t?"touch":this.pointerLock?"mouse":L.pointer&&!s?"pointer":L.touch?"touch":"mouse"},preventScrollAxis(r,e,{preventScroll:t}){if(this.preventScrollDelay=typeof t=="number"?t:t||t===void 0&&r?kn:void 0,!(!L.touchscreen||t===!1))return r||(t!==void 0?"y":void 0)},pointerCapture(r,e,{pointer:{capture:t=!0,buttons:n=1,keys:s=!0}={}}){return this.pointerButtons=n,this.keys=s,!this.pointerLock&&this.device==="pointer"&&t},threshold(r,e,{filterTaps:t=!1,tapsThreshold:n=3,axis:s=void 0}){let i=O.toVector(r,t?n:s?1:0);return this.filterTaps=t,this.tapsThreshold=n,i},swipe({velocity:r=Rn,distance:e=Bn,duration:t=$n}={}){return{velocity:this.transform(O.toVector(r)),distance:this.transform(O.toVector(e)),duration:t}},delay(r=0){switch(r){case!0:return jn;case!1:return 0;default:return r}},axisThreshold(r){return r?E(E({},Yt),r):Yt},keyboardDisplacement(r=Nn){return r}});function nr(r){let[e,t]=r.overflow,[n,s]=r._delta,[i,o]=r._direction;(e<0&&n>0&&i<0||e>0&&n<0&&i>0)&&(r._movement[0]=r._movementBound[0]),(t<0&&s>0&&o<0||t>0&&s<0&&o>0)&&(r._movement[1]=r._movementBound[1])}var zn=30,Fn=100,tt=class extends Se{constructor(...e){super(...e),I(this,"ingKey","pinching"),I(this,"aliasKey","da")}init(){this.state.offset=[1,0],this.state.lastOffset=[1,0],this.state._pointerEvents=new Map}reset(){super.reset();let e=this.state;e._touchIds=[],e.canceled=!1,e.cancel=this.cancel.bind(this),e.turns=0}computeOffset(){let{type:e,movement:t,lastOffset:n}=this.state;e==="wheel"?this.state.offset=O.add(t,n):this.state.offset=[(1+t[0])*n[0],t[1]+n[1]]}computeMovement(){let{offset:e,lastOffset:t}=this.state;this.state.movement=[e[0]/t[0],e[1]-t[1]]}axisIntent(){let e=this.state,[t,n]=e._movement;if(!e.axis){let s=Math.abs(t)*zn-Math.abs(n);s<0?e.axis="angle":s>0&&(e.axis="scale")}}restrictToAxis(e){this.config.lockDirection&&(this.state.axis==="scale"?e[1]=0:this.state.axis==="angle"&&(e[0]=0))}cancel(){let e=this.state;e.canceled||setTimeout(()=>{e.canceled=!0,e._active=!1,this.compute(),this.emit()},0)}touchStart(e){this.ctrl.setEventIds(e);let t=this.state,n=this.ctrl.touchIds;if(t._active&&t._touchIds.every(i=>n.has(i))||n.size<2)return;this.start(e),t._touchIds=Array.from(n).slice(0,2);let s=Nt(e,t._touchIds);s&&this.pinchStart(e,s)}pointerStart(e){if(e.buttons!=null&&e.buttons%2!==1)return;this.ctrl.setEventIds(e),e.target.setPointerCapture(e.pointerId);let t=this.state,n=t._pointerEvents,s=this.ctrl.pointerIds;if(t._active&&Array.from(n.keys()).every(o=>s.has(o))||(n.size<2&&n.set(e.pointerId,e),t._pointerEvents.size<2))return;this.start(e);let i=Je(...Array.from(n.values()));i&&this.pinchStart(e,i)}pinchStart(e,t){let n=this.state;n.origin=t.origin,this.computeValues([t.distance,t.angle]),this.computeInitial(),this.compute(e),this.emit()}touchMove(e){if(!this.state._active)return;let t=Nt(e,this.state._touchIds);t&&this.pinchMove(e,t)}pointerMove(e){let t=this.state._pointerEvents;if(t.has(e.pointerId)&&t.set(e.pointerId,e),!this.state._active)return;let n=Je(...Array.from(t.values()));n&&this.pinchMove(e,n)}pinchMove(e,t){let n=this.state,s=n._values[1],i=t.angle-s,o=0;Math.abs(i)>270&&(o+=Math.sign(i)),this.computeValues([t.distance,t.angle-360*o]),n.origin=t.origin,n.turns=o,n._movement=[n._values[0]/n._initial[0]-1,n._values[1]-n._initial[1]],this.compute(e),this.emit()}touchEnd(e){this.ctrl.setEventIds(e),this.state._active&&this.state._touchIds.some(t=>!this.ctrl.touchIds.has(t))&&(this.state._active=!1,this.compute(e),this.emit())}pointerEnd(e){let t=this.state;this.ctrl.setEventIds(e);try{e.target.releasePointerCapture(e.pointerId)}catch{}t._pointerEvents.has(e.pointerId)&&t._pointerEvents.delete(e.pointerId),t._active&&t._pointerEvents.size<2&&(t._active=!1,this.compute(e),this.emit())}gestureStart(e){e.cancelable&&e.preventDefault();let t=this.state;t._active||(this.start(e),this.computeValues([e.scale,e.rotation]),t.origin=[e.clientX,e.clientY],this.compute(e),this.emit())}gestureMove(e){if(e.cancelable&&e.preventDefault(),!this.state._active)return;let t=this.state;this.computeValues([e.scale,e.rotation]),t.origin=[e.clientX,e.clientY];let n=t._movement;t._movement=[e.scale-1,e.rotation],t._delta=O.sub(t._movement,n),this.compute(e),this.emit()}gestureEnd(e){this.state._active&&(this.state._active=!1,this.compute(e),this.emit())}wheel(e){let t=this.config.modifierKey;t&&!e[t]||(this.state._active?this.wheelChange(e):this.wheelStart(e),this.timeoutStore.add("wheelEnd",this.wheelEnd.bind(this)))}wheelStart(e){this.start(e),this.wheelChange(e)}wheelChange(e){"uv"in e||e.cancelable&&e.preventDefault();let n=this.state;n._delta=[-er(e)[1]/Fn*n.offset[0],0],O.addTo(n._movement,n._delta),nr(n),this.state.origin=[e.clientX,e.clientY],this.compute(e),this.emit()}wheelEnd(){this.state._active&&(this.state._active=!1,this.compute(),this.emit())}bind(e){let t=this.config.device;t&&(e(t,"start",this[t+"Start"].bind(this)),e(t,"change",this[t+"Move"].bind(this)),e(t,"end",this[t+"End"].bind(this)),e(t,"cancel",this[t+"End"].bind(this))),this.config.pinchOnWheel&&e("wheel","",this.wheel.bind(this),{passive:!1})}},Vn=E(E({},rr),{},{device(r,e,{shared:t,pointer:{touch:n=!1}={}}){if(t.target&&!L.touch&&L.gesture)return"gesture";if(L.touch&&n)return"touch";if(L.touchscreen){if(L.pointer)return"pointer";if(L.touch)return"touch"}},bounds(r,e,{scaleBounds:t={},angleBounds:n={}}){let s=o=>{let a=Ft(xe(t,o),{min:-1/0,max:1/0});return[a.min,a.max]},i=o=>{let a=Ft(xe(n,o),{min:-1/0,max:1/0});return[a.min,a.max]};return typeof t!="function"&&typeof n!="function"?[s(),i()]:o=>[s(o),i(o)]},threshold(r,e,t){return this.lockDirection=t.axis==="lock",O.toVector(r,this.lockDirection?[.1,3]:0)},modifierKey(r){return r===void 0?"ctrlKey":r},pinchOnWheel(r=!0){return r}}),rt=class extends V{constructor(...e){super(...e),I(this,"ingKey","moving")}move(e){this.config.mouseOnly&&e.pointerType!=="mouse"||(this.state._active?this.moveChange(e):this.moveStart(e),this.timeoutStore.add("moveEnd",this.moveEnd.bind(this)))}moveStart(e){this.start(e),this.computeValues(W(e)),this.compute(e),this.computeInitial(),this.emit()}moveChange(e){if(!this.state._active)return;let t=W(e),n=this.state;n._delta=O.sub(t,n._values),O.addTo(n._movement,n._delta),this.computeValues(t),this.compute(e),this.emit()}moveEnd(e){this.state._active&&(this.state._active=!1,this.compute(e),this.emit())}bind(e){e("pointer","change",this.move.bind(this)),e("pointer","leave",this.moveEnd.bind(this))}},Gn=E(E({},G),{},{mouseOnly:(r=!0)=>r}),nt=class extends V{constructor(...e){super(...e),I(this,"ingKey","scrolling")}scroll(e){this.state._active||this.start(e),this.scrollChange(e),this.timeoutStore.add("scrollEnd",this.scrollEnd.bind(this))}scrollChange(e){e.cancelable&&e.preventDefault();let t=this.state,n=xn(e);t._delta=O.sub(n,t._values),O.addTo(t._movement,t._delta),this.computeValues(n),this.compute(e),this.emit()}scrollEnd(){this.state._active&&(this.state._active=!1,this.compute(),this.emit())}bind(e){e("scroll","",this.scroll.bind(this))}},Hn=G,st=class extends V{constructor(...e){super(...e),I(this,"ingKey","wheeling")}wheel(e){this.state._active||this.start(e),this.wheelChange(e),this.timeoutStore.add("wheelEnd",this.wheelEnd.bind(this))}wheelChange(e){let t=this.state;t._delta=er(e),O.addTo(t._movement,t._delta),nr(t),this.compute(e),this.emit()}wheelEnd(){this.state._active&&(this.state._active=!1,this.compute(),this.emit())}bind(e){e("wheel","",this.wheel.bind(this))}},Yn=G,it=class extends V{constructor(...e){super(...e),I(this,"ingKey","hovering")}enter(e){this.config.mouseOnly&&e.pointerType!=="mouse"||(this.start(e),this.computeValues(W(e)),this.compute(e),this.emit())}leave(e){if(this.config.mouseOnly&&e.pointerType!=="mouse")return;let t=this.state;if(!t._active)return;t._active=!1;let n=W(e);t._movement=t._delta=O.sub(n,t._values),this.computeValues(n),this.compute(e),t.delta=t.movement,this.emit()}bind(e){e("pointer","enter",this.enter.bind(this)),e("pointer","leave",this.leave.bind(this))}},Kn=E(E({},G),{},{mouseOnly:(r=!0)=>r}),ue=new Map,le=new Map;function ot(r){ue.set(r.key,r.engine),le.set(r.key,r.resolver)}var at={key:"drag",engine:et,resolver:Un},ct={key:"hover",engine:it,resolver:Kn},ut={key:"move",engine:rt,resolver:Gn},lt={key:"pinch",engine:tt,resolver:Vn},ft={key:"scroll",engine:nt,resolver:Hn},ht={key:"wheel",engine:st,resolver:Yn};function Wn(r,e){if(r==null)return{};var t={},n=Object.keys(r),s,i;for(i=0;i<n.length;i++)s=n[i],!(e.indexOf(s)>=0)&&(t[s]=r[s]);return t}function qn(r,e){if(r==null)return{};var t=Wn(r,e),n,s;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(r);for(s=0;s<i.length;s++)n=i[s],!(e.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(r,n)&&(t[n]=r[n])}return t}var Zn={target(r){if(r)return()=>"current"in r?r.current:r},enabled(r=!0){return r},window(r=L.isBrowser?window:void 0){return r},eventOptions({passive:r=!0,capture:e=!1}={}){return{passive:r,capture:e}},transform(r){return r}},Xn=["target","eventOptions","window","enabled","transform"];function Oe(r={},e){let t={};for(let[n,s]of Object.entries(e))switch(typeof s){case"function":t[n]=s.call(t,r[n],n,r);break;case"object":t[n]=Oe(r[n],s);break;case"boolean":s&&(t[n]=r[n]);break}return t}function Qn(r,e,t={}){let n=r,{target:s,eventOptions:i,window:o,enabled:a,transform:c}=n,u=qn(n,Xn);if(t.shared=Oe({target:s,eventOptions:i,window:o,enabled:a,transform:c},Zn),e){let l=le.get(e);t[e]=Oe(E({shared:t.shared},u),l)}else for(let l in u){let p=le.get(l);p&&(t[l]=Oe(E({shared:t.shared},u[l]),p))}return t}var Te=class{constructor(e,t){I(this,"_listeners",new Set),this._ctrl=e,this._gestureKey=t}add(e,t,n,s,i){let o=this._listeners,a=Zt(t,n),c=this._gestureKey?this._ctrl.config[this._gestureKey].eventOptions:{},u=E(E({},c),i);e.addEventListener(a,s,u);let l=()=>{e.removeEventListener(a,s,u),o.delete(l)};return o.add(l),l}clean(){this._listeners.forEach(e=>e()),this._listeners.clear()}},pt=class{constructor(){I(this,"_timeouts",new Map)}add(e,t,n=140,...s){this.remove(e),this._timeouts.set(e,window.setTimeout(t,n,...s))}remove(e){let t=this._timeouts.get(e);t&&window.clearTimeout(t)}clean(){this._timeouts.forEach(e=>void window.clearTimeout(e)),this._timeouts.clear()}},Ee=class{constructor(e){I(this,"gestures",new Set),I(this,"_targetEventStore",new Te(this)),I(this,"gestureEventStores",{}),I(this,"gestureTimeoutStores",{}),I(this,"handlers",{}),I(this,"config",{}),I(this,"pointerIds",new Set),I(this,"touchIds",new Set),I(this,"state",{shared:{shiftKey:!1,metaKey:!1,ctrlKey:!1,altKey:!1}}),Jn(this,e)}setEventIds(e){if(ae(e))return this.touchIds=new Set(Jt(e)),this.touchIds;if("pointerId"in e)return e.type==="pointerup"||e.type==="pointercancel"?this.pointerIds.delete(e.pointerId):e.type==="pointerdown"&&this.pointerIds.add(e.pointerId),this.pointerIds}applyHandlers(e,t){this.handlers=e,this.nativeHandlers=t}applyConfig(e,t){this.config=Qn(e,t,this.config)}clean(){this._targetEventStore.clean();for(let e of this.gestures)this.gestureEventStores[e].clean(),this.gestureTimeoutStores[e].clean()}effect(){return this.config.shared.target&&this.bind(),()=>this._targetEventStore.clean()}bind(...e){let t=this.config.shared,n={},s;if(!(t.target&&(s=t.target(),!s))){if(t.enabled){for(let o of this.gestures){let a=this.config[o],c=sr(n,a.eventOptions,!!s);if(a.enabled){let u=ue.get(o);new u(this,e,o).bind(c)}}let i=sr(n,t.eventOptions,!!s);for(let o in this.nativeHandlers)i(o,"",a=>this.nativeHandlers[o](E(E({},this.state.shared),{},{event:a,args:e})),void 0,!0)}for(let i in n)n[i]=tr(...n[i]);if(!s)return n;for(let i in n){let{device:o,capture:a,passive:c}=qt(i);this._targetEventStore.add(s,o,"",n[i],{capture:a,passive:c})}}}};function q(r,e){r.gestures.add(e),r.gestureEventStores[e]=new Te(r,e),r.gestureTimeoutStores[e]=new pt}function Jn(r,e){e.drag&&q(r,"drag"),e.wheel&&q(r,"wheel"),e.scroll&&q(r,"scroll"),e.move&&q(r,"move"),e.pinch&&q(r,"pinch"),e.hover&&q(r,"hover")}var sr=(r,e,t)=>(n,s,i,o={},a=!1)=>{var c,u;let l=(c=o.capture)!==null&&c!==void 0?c:e.capture,p=(u=o.passive)!==null&&u!==void 0?u:e.passive,d=a?n:Wt(n,s,l);t&&p&&(d+="Passive"),r[d]=r[d]||[],r[d].push(i)},es=/^on(Drag|Wheel|Scroll|Move|Pinch|Hover)/;function ts(r){let e={},t={},n=new Set;for(let s in r)es.test(s)?(n.add(RegExp.lastMatch),t[s]=r[s]):e[s]=r[s];return[t,e,n]}function Z(r,e,t,n,s,i){if(!r.has(t)||!ue.has(n))return;let o=t+"Start",a=t+"End",c=u=>{let l;return u.first&&o in e&&e[o](u),t in e&&(l=e[t](u)),u.last&&a in e&&e[a](u),l};s[n]=c,i[n]=i[n]||{}}function ir(r,e){let[t,n,s]=ts(r),i={};return Z(s,t,"onDrag","drag",i,e),Z(s,t,"onWheel","wheel",i,e),Z(s,t,"onScroll","scroll",i,e),Z(s,t,"onPinch","pinch",i,e),Z(s,t,"onMove","move",i,e),Z(s,t,"onHover","hover",i,e),{handlers:i,config:e,nativeHandlers:n}}function rs(r,e){if(typeof r!="object"||r===null)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function ns(r){var e=rs(r,"string");return typeof e=="symbol"?e:String(e)}function ss(r,e,t){return e=ns(e),e in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function or(r,e){var t=Object.keys(r);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(r);e&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(r,s).enumerable})),t.push.apply(t,n)}return t}function Me(r){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?or(Object(t),!0).forEach(function(n){ss(r,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(t)):or(Object(t)).forEach(function(n){Object.defineProperty(r,n,Object.getOwnPropertyDescriptor(t,n))})}return r}var mt=class{constructor(e,t,n,s,i){this._target=e,this._gestureKey=s,this._ctrl=new Ee(t),this._ctrl.applyHandlers(t,i),this._ctrl.applyConfig(Me(Me({},n),{},{target:e}),s),this._ctrl.effect()}destroy(){this._ctrl.clean()}setConfig(e){this._ctrl.clean(),this._ctrl.applyConfig(Me(Me({},e),{},{target:this._target}),this._gestureKey),this._ctrl.effect()}};function is(r){return r.forEach(ot),function(e,t,n){let{handlers:s,nativeHandlers:i,config:o}=ir(t,n||{});return new mt(e,s,o,void 0,i)}}var ar=function(e,t,n){return is([at,lt,ft,ht,ut,ct])(e,t,n||{})};function Ie(r,e){var t={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(t[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(r);s<n.length;s++)e.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(r,n[s])&&(t[n[s]]=r[n[s]]);return t}var Le=function(){},X=function(){};var fe=(r,e,t)=>Math.min(Math.max(t,r),e);var dt=.001,os=.01,cr=10,as=.05,cs=1;function ur({duration:r=800,bounce:e=.25,velocity:t=0,mass:n=1}){let s,i;Le(r<=cr*1e3,"Spring duration must be 10 seconds or less");let o=1-e;o=fe(as,cs,o),r=fe(os,cr,r/1e3),o<1?(s=u=>{let l=u*o,p=l*r,d=l-t,b=Ae(u,o),g=Math.exp(-p);return dt-d/b*g},i=u=>{let p=u*o*r,d=p*t+t,b=Math.pow(o,2)*Math.pow(u,2)*r,g=Math.exp(-p),v=Ae(Math.pow(u,2),o);return(-s(u)+dt>0?-1:1)*((d-b)*g)/v}):(s=u=>{let l=Math.exp(-u*r),p=(u-t)*r+1;return-dt+l*p},i=u=>{let l=Math.exp(-u*r),p=(t-u)*(r*r);return l*p});let a=5/r,c=ls(s,i,a);if(r=r*1e3,isNaN(c))return{stiffness:100,damping:10,duration:r};{let u=Math.pow(c,2)*n;return{stiffness:u,damping:o*2*Math.sqrt(n*u),duration:r}}}var us=12;function ls(r,e,t){let n=t;for(let s=1;s<us;s++)n=n-r(n)/e(n);return n}function Ae(r,e){return r*Math.sqrt(1-e*e)}var fs=["duration","bounce"],hs=["stiffness","damping","mass"];function lr(r,e){return e.some(t=>r[t]!==void 0)}function ps(r){let e=Object.assign({velocity:0,stiffness:100,damping:10,mass:1,isResolvedFromDuration:!1},r);if(!lr(r,hs)&&lr(r,fs)){let t=ur(r);e=Object.assign(Object.assign(Object.assign({},e),t),{velocity:0,mass:1}),e.isResolvedFromDuration=!0}return e}function De(r){var{from:e=0,to:t=1,restSpeed:n=2,restDelta:s}=r,i=Ie(r,["from","to","restSpeed","restDelta"]);let o={done:!1,value:e},{stiffness:a,damping:c,mass:u,velocity:l,duration:p,isResolvedFromDuration:d}=ps(i),b=fr,g=fr;function v(){let _=l?-(l/1e3):0,m=t-e,f=c/(2*Math.sqrt(a*u)),h=Math.sqrt(a/u)/1e3;if(s===void 0&&(s=Math.min(Math.abs(t-e)/100,.4)),f<1){let y=Ae(h,f);b=w=>{let S=Math.exp(-f*h*w);return t-S*((_+f*h*m)/y*Math.sin(y*w)+m*Math.cos(y*w))},g=w=>{let S=Math.exp(-f*h*w);return f*h*S*(Math.sin(y*w)*(_+f*h*m)/y+m*Math.cos(y*w))-S*(Math.cos(y*w)*(_+f*h*m)-y*m*Math.sin(y*w))}}else if(f===1)b=y=>t-Math.exp(-h*y)*(m+(_+h*m)*y);else{let y=h*Math.sqrt(f*f-1);b=w=>{let S=Math.exp(-f*h*w),M=Math.min(y*w,300);return t-S*((_+f*h*m)*Math.sinh(M)+y*m*Math.cosh(M))/y}}}return v(),{next:_=>{let m=b(_);if(d)o.done=_>=p;else{let f=g(_)*1e3,h=Math.abs(f)<=n,y=Math.abs(t-m)<=s;o.done=h&&y}return o.value=o.done?t:m,o},flipTarget:()=>{l=-l,[e,t]=[t,e],v()}}}De.needsInterpolation=(r,e)=>typeof r=="string"||typeof e=="string";var fr=r=>0;var gt=(r,e,t)=>{let n=e-r;return n===0?1:(t-r)/n};var Q=(r,e,t)=>-t*r+t*e+r;var Pe=(r,e)=>t=>Math.max(Math.min(t,e),r),U=r=>r%1?Number(r.toFixed(5)):r,J=/(-)?([\d]*\.?[\d])+/g,Ce=/(#[0-9a-f]{6}|#[0-9a-f]{3}|#(?:[0-9a-f]{2}){2,4}|(rgb|hsl)a?\((-?[\d\.]+%?[,\s]+){2}(-?[\d\.]+%?)\s*[\,\/]?\s*[\d\.]*%?\))/gi,hr=/^(#[0-9a-f]{3}|#(?:[0-9a-f]{2}){2,4}|(rgb|hsl)a?\((-?[\d\.]+%?[,\s]+){2}(-?[\d\.]+%?)\s*[\,\/]?\s*[\d\.]*%?\))$/i;function R(r){return typeof r=="string"}var ee={test:r=>typeof r=="number",parse:parseFloat,transform:r=>r},ke=Object.assign(Object.assign({},ee),{transform:Pe(0,1)}),So=Object.assign(Object.assign({},ee),{default:1});var he=r=>({test:e=>R(e)&&e.endsWith(r)&&e.split(" ").length===1,parse:parseFloat,transform:e=>`${e}${r}`}),Eo=he("deg"),te=he("%"),Mo=he("px"),Io=he("vh"),Lo=he("vw"),Ao=Object.assign(Object.assign({},te),{parse:r=>te.parse(r)/100,transform:r=>te.transform(r*100)});var re=(r,e)=>t=>!!(R(t)&&hr.test(t)&&t.startsWith(r)||e&&Object.prototype.hasOwnProperty.call(t,e)),je=(r,e,t)=>n=>{if(!R(n))return n;let[s,i,o,a]=n.match(J);return{[r]:parseFloat(s),[e]:parseFloat(i),[t]:parseFloat(o),alpha:a!==void 0?parseFloat(a):1}};var C={test:re("hsl","hue"),parse:je("hue","saturation","lightness"),transform:({hue:r,saturation:e,lightness:t,alpha:n=1})=>"hsla("+Math.round(r)+", "+te.transform(U(e))+", "+te.transform(U(t))+", "+U(ke.transform(n))+")"};var ms=Pe(0,255),Re=Object.assign(Object.assign({},ee),{transform:r=>Math.round(ms(r))}),A={test:re("rgb","red"),parse:je("red","green","blue"),transform:({red:r,green:e,blue:t,alpha:n=1})=>"rgba("+Re.transform(r)+", "+Re.transform(e)+", "+Re.transform(t)+", "+U(ke.transform(n))+")"};function ds(r){let e="",t="",n="",s="";return r.length>5?(e=r.substr(1,2),t=r.substr(3,2),n=r.substr(5,2),s=r.substr(7,2)):(e=r.substr(1,1),t=r.substr(2,1),n=r.substr(3,1),s=r.substr(4,1),e+=e,t+=t,n+=n,s+=s),{red:parseInt(e,16),green:parseInt(t,16),blue:parseInt(n,16),alpha:s?parseInt(s,16)/255:1}}var ne={test:re("#"),parse:ds,transform:A.transform};var z={test:r=>A.test(r)||ne.test(r)||C.test(r),parse:r=>A.test(r)?A.parse(r):C.test(r)?C.parse(r):ne.parse(r),transform:r=>R(r)?r:r.hasOwnProperty("red")?A.transform(r):C.transform(r)};var pr="${c}",mr="${n}";function gs(r){var e,t,n,s;return isNaN(r)&&R(r)&&((t=(e=r.match(J))===null||e===void 0?void 0:e.length)!==null&&t!==void 0?t:0)+((s=(n=r.match(Ce))===null||n===void 0?void 0:n.length)!==null&&s!==void 0?s:0)>0}function dr(r){typeof r=="number"&&(r=`${r}`);let e=[],t=0,n=r.match(Ce);n&&(t=n.length,r=r.replace(Ce,pr),e.push(...n.map(z.parse)));let s=r.match(J);return s&&(r=r.replace(J,mr),e.push(...s.map(ee.parse))),{values:e,numColors:t,tokenised:r}}function gr(r){return dr(r).values}function yr(r){let{values:e,numColors:t,tokenised:n}=dr(r),s=e.length;return i=>{let o=n;for(let a=0;a<s;a++)o=o.replace(a<t?pr:mr,a<t?z.transform(i[a]):U(i[a]));return o}}var ys=r=>typeof r=="number"?0:r;function vs(r){let e=gr(r);return yr(r)(e.map(ys))}var Be={test:gs,parse:gr,createTransformer:yr,getAnimatableNone:vs};function yt(r,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?r+(e-r)*6*t:t<1/2?e:t<2/3?r+(e-r)*(2/3-t)*6:r}function vt({hue:r,saturation:e,lightness:t,alpha:n}){r/=360,e/=100,t/=100;let s=0,i=0,o=0;if(!e)s=i=o=t;else{let a=t<.5?t*(1+e):t+e-t*e,c=2*t-a;s=yt(c,a,r+1/3),i=yt(c,a,r),o=yt(c,a,r-1/3)}return{red:Math.round(s*255),green:Math.round(i*255),blue:Math.round(o*255),alpha:n}}var bs=(r,e,t)=>{let n=r*r,s=e*e;return Math.sqrt(Math.max(0,t*(s-n)+n))},_s=[ne,A,C],vr=r=>_s.find(e=>e.test(r)),br=r=>`'${r}' is not an animatable color. Use the equivalent color code instead.`,$e=(r,e)=>{let t=vr(r),n=vr(e);X(!!t,br(r)),X(!!n,br(e));let s=t.parse(r),i=n.parse(e);t===C&&(s=vt(s),t=A),n===C&&(i=vt(i),n=A);let o=Object.assign({},s);return a=>{for(let c in o)c!=="alpha"&&(o[c]=bs(s[c],i[c],a));return o.alpha=Q(s.alpha,i.alpha,a),t.transform(o)}};var _r=r=>typeof r=="number";var ws=(r,e)=>t=>e(r(t)),Ne=(...r)=>r.reduce(ws);function xr(r,e){return _r(r)?t=>Q(r,e,t):z.test(r)?$e(r,e):_t(r,e)}var bt=(r,e)=>{let t=[...r],n=t.length,s=r.map((i,o)=>xr(i,e[o]));return i=>{for(let o=0;o<n;o++)t[o]=s[o](i);return t}},Sr=(r,e)=>{let t=Object.assign(Object.assign({},r),e),n={};for(let s in t)r[s]!==void 0&&e[s]!==void 0&&(n[s]=xr(r[s],e[s]));return s=>{for(let i in n)t[i]=n[i](s);return t}};function wr(r){let e=Be.parse(r),t=e.length,n=0,s=0,i=0;for(let o=0;o<t;o++)n||typeof e[o]=="number"?n++:e[o].hue!==void 0?i++:s++;return{parsed:e,numNumbers:n,numRGB:s,numHSL:i}}var _t=(r,e)=>{let t=Be.createTransformer(e),n=wr(r),s=wr(e);return n.numHSL===s.numHSL&&n.numRGB===s.numRGB&&n.numNumbers>=s.numNumbers?Ne(bt(n.parsed,s.parsed),t):(Le(!0,`Complex values '${r}' and '${e}' too different to mix. Ensure all colors are of the same type, and that each contains the same quantity of number and color values. Falling back to instant transition.`),o=>`${o>0?e:r}`)};var xs=(r,e)=>t=>Q(r,e,t);function Ss(r){if(typeof r=="number")return xs;if(typeof r=="string")return z.test(r)?$e:_t;if(Array.isArray(r))return bt;if(typeof r=="object")return Sr}function Os(r,e,t){let n=[],s=t||Ss(r[0]),i=r.length-1;for(let o=0;o<i;o++){let a=s(r[o],r[o+1]);if(e){let c=Array.isArray(e)?e[o]:e;a=Ne(c,a)}n.push(a)}return n}function Ts([r,e],[t]){return n=>t(gt(r,e,n))}function Es(r,e){let t=r.length,n=t-1;return s=>{let i=0,o=!1;if(s<=r[0]?o=!0:s>=r[n]&&(i=n-1,o=!0),!o){let c=1;for(;c<t&&!(r[c]>s||c===n);c++);i=c-1}let a=gt(r[i],r[i+1],s);return e[i](a)}}function Ue(r,e,{clamp:t=!0,ease:n,mixer:s}={}){let i=r.length;X(i===e.length,"Both input and output ranges must be the same length"),X(!n||!Array.isArray(n)||n.length===i-1,"Array of easing functions must be of length `input.length - 1`, as it applies to the transitions **between** the defined values."),r[0]>r[i-1]&&(r=[].concat(r),e=[].concat(e),r.reverse(),e.reverse());let o=Os(e,n,s),a=i===2?Ts(r,o):Es(r,o);return t?c=>a(fe(r[0],r[i-1],c)):a}var pe=r=>e=>1-r(1-e),ze=r=>e=>e<=.5?r(2*e)/2:(2-r(2*(1-e)))/2,Or=r=>e=>Math.pow(e,r),wt=r=>e=>e*e*((r+1)*e-r),Tr=r=>{let e=wt(r);return t=>(t*=2)<1?.5*e(t):.5*(2-Math.pow(2,-10*(t-1)))};var Er=1.525,Ms=4/11,Is=8/11,Ls=9/10;var Mr=Or(2),Ca=pe(Mr),Ir=ze(Mr),As=r=>1-Math.sin(Math.acos(r)),Ds=pe(As),ka=ze(Ds),Lr=wt(Er),ja=pe(Lr),Ra=ze(Lr),Ba=Tr(Er),Ps=4356/361,Cs=35442/1805,ks=16061/1805,js=r=>{if(r===1||r===0)return r;let e=r*r;return r<Ms?7.5625*e:r<Is?9.075*e-9.9*r+3.4:r<Ls?Ps*e-Cs*r+ks:10.8*r*r-20.52*r+10.72},$a=pe(js);function Rs(r,e){return r.map(()=>e||Ir).splice(0,r.length-1)}function Bs(r){let e=r.length;return r.map((t,n)=>n!==0?n/(e-1):0)}function $s(r,e){return r.map(t=>t*e)}function me({from:r=0,to:e=1,ease:t,offset:n,duration:s=300}){let i={done:!1,value:r},o=Array.isArray(e)?e:[r,e],a=$s(n&&n.length===o.length?n:Bs(o),s);function c(){return Ue(a,o,{ease:Array.isArray(t)?t:Rs(o,t)})}let u=c();return{next:l=>(i.value=u(l),i.done=l>=s,i),flipTarget:()=>{o.reverse(),u=c()}}}function Ar({velocity:r=0,from:e=0,power:t=.8,timeConstant:n=350,restDelta:s=.5,modifyTarget:i}){let o={done:!1,value:e},a=t*r,c=e+a,u=i===void 0?c:i(c);return u!==c&&(a=u-e),{next:l=>{let p=-a*Math.exp(-l/n);return o.done=!(p>s||p<-s),o.value=o.done?u:u+p,o},flipTarget:()=>{}}}var Dr={keyframes:me,spring:De,decay:Ar};function Pr(r){if(Array.isArray(r.to))return me;if(Dr[r.type])return Dr[r.type];let e=new Set(Object.keys(r));return e.has("ease")||e.has("duration")&&!e.has("dampingRatio")?me:e.has("dampingRatio")||e.has("stiffness")||e.has("mass")||e.has("damping")||e.has("restSpeed")||e.has("restDelta")?De:me}var xt=16.666666666666668,Ns=typeof performance<"u"?()=>performance.now():()=>Date.now(),St=typeof window<"u"?r=>window.requestAnimationFrame(r):r=>setTimeout(()=>r(Ns()),xt);function Cr(r){let e=[],t=[],n=0,s=!1,i=!1,o=new WeakSet,a={schedule:(c,u=!1,l=!1)=>{let p=l&&s,d=p?e:t;return u&&o.add(c),d.indexOf(c)===-1&&(d.push(c),p&&s&&(n=e.length)),c},cancel:c=>{let u=t.indexOf(c);u!==-1&&t.splice(u,1),o.delete(c)},process:c=>{if(s){i=!0;return}if(s=!0,[e,t]=[t,e],t.length=0,n=e.length,n)for(let u=0;u<n;u++){let l=e[u];l(c),o.has(l)&&(a.schedule(l),r())}s=!1,i&&(i=!1,a.process(c))}};return a}var Us=40,Ot=!0,de=!1,Tt=!1,se={delta:0,timestamp:0},ge=["read","update","preRender","render","postRender"],Fe=ge.reduce((r,e)=>(r[e]=Cr(()=>de=!0),r),{}),zs=ge.reduce((r,e)=>{let t=Fe[e];return r[e]=(n,s=!1,i=!1)=>(de||Vs(),t.schedule(n,s,i)),r},{}),kr=ge.reduce((r,e)=>(r[e]=Fe[e].cancel,r),{}),Qa=ge.reduce((r,e)=>(r[e]=()=>Fe[e].process(se),r),{}),Fs=r=>Fe[r].process(se),jr=r=>{de=!1,se.delta=Ot?xt:Math.max(Math.min(r-se.timestamp,Us),1),se.timestamp=r,Tt=!0,ge.forEach(Fs),Tt=!1,de&&(Ot=!1,St(jr))},Vs=()=>{de=!0,Ot=!0,Tt||St(jr)},Rr=()=>se,Br=zs;function Et(r,e,t=0){return r-e-t}function $r(r,e,t=0,n=!0){return n?Et(e+-r,e,t):e-(r-e)+t}function Nr(r,e,t,n){return n?r>=e+t:r<=-t}var Gs=r=>{let e=({delta:t})=>r(t);return{start:()=>Br.update(e,!0),stop:()=>kr.update(e)}};function Ur(r){var e,t,{from:n,autoplay:s=!0,driver:i=Gs,elapsed:o=0,repeat:a=0,repeatType:c="loop",repeatDelay:u=0,onPlay:l,onStop:p,onComplete:d,onRepeat:b,onUpdate:g}=r,v=Ie(r,["from","autoplay","driver","elapsed","repeat","repeatType","repeatDelay","onPlay","onStop","onComplete","onRepeat","onUpdate"]);let{to:_}=v,m,f=0,h=v.duration,y,w=!1,S=!0,M,D=Pr(v);!((t=(e=D).needsInterpolation)===null||t===void 0)&&t.call(e,n,_)&&(M=Ue([0,100],[n,_],{clamp:!1}),n=0,_=100);let P=D(Object.assign(Object.assign({},v),{from:n,to:_}));function K(){f++,c==="reverse"?(S=f%2===0,o=$r(o,h,u,S)):(o=Et(o,h,u),c==="mirror"&&P.flipTarget()),w=!1,b&&b()}function F(){m.stop(),d&&d()}function hn(Xe){if(S||(Xe=-Xe),o+=Xe,!w){let Ct=P.next(Math.max(0,o));y=Ct.value,M&&(y=M(y)),w=S?Ct.done:o<=0}g?.(y),w&&(f===0&&(h??(h=o)),f<a?Nr(o,h,u,S)&&K():F())}function pn(){l?.(),m=i(hn),m.start()}return s&&pn(),{stop:()=>{p?.(),m.stop()}}}function zr(r,e){return e?r*(1e3/e):0}function B({from:r=0,velocity:e=0,min:t,max:n,power:s=.8,timeConstant:i=750,bounceStiffness:o=500,bounceDamping:a=10,restDelta:c=1,modifyTarget:u,driver:l,onUpdate:p,onComplete:d,onStop:b}){let g;function v(h){return t!==void 0&&h<t||n!==void 0&&h>n}function _(h){return t===void 0?n:n===void 0||Math.abs(t-h)<Math.abs(n-h)?t:n}function m(h){g?.stop(),g=Ur(Object.assign(Object.assign({},h),{driver:l,onUpdate:y=>{var w;p?.(y),(w=h.onUpdate)===null||w===void 0||w.call(h,y)},onComplete:d,onStop:b}))}function f(h){m(Object.assign({type:"spring",stiffness:o,damping:a,restDelta:c},h))}if(v(r))f({from:r,velocity:e,to:_(r)});else{let h=s*e+r;typeof u<"u"&&(h=u(h));let y=_(h),w=y===t?-1:1,S,M,D=P=>{S=M,M=P,e=zr(P-S,Rr().delta),(w===1&&P>y||w===-1&&P<y)&&f({from:P,to:y,velocity:e})};m({type:"decay",from:r,velocity:e,timeConstant:i,power:s,restDelta:c,modifyTarget:u,onUpdate:v(h)?D:void 0})}return{stop:()=>g?.stop()}}var ye=class{count=0;length=0;data=[];constructor(e=3){this.length=e}add(e){this.data[this.count%this.length]=e,this.count+=1}clear(){this.data=Array(length)}get value(){let e=this.data.filter(t=>t!=null);return e.length==0?0:e.reduce((t,n)=>t+n,0)/e.length}},Ve=class{map;initialScale=0;lastPinchTime=0;lastWheelTime=0;lastClickTime=0;lastDragTime=0;scaleAnimation=B({});offsetAnimation=[B({}),B({})];velocity=[new ye,new ye];velocityScale=new ye;constructor(e){this.map=e,new ar(this.map.element,{onWheel:this.onWheel.bind(this),onPinchStart:()=>this.initialScale=this.map.scale,onPinch:this.onPinch.bind(this),onPinchEnd:this.onPinchEnd.bind(this),onDragStart:this.onDragStart.bind(this),onDrag:this.onDrag.bind(this),onDragEnd:this.onDragEnd.bind(this),onClick:this.onClick.bind(this)})}onWheel({direction:e,event:t,delta:n,timeStamp:s}){if(s==this.lastWheelTime)return;this.offsetAnimation[0]?.stop(),this.offsetAnimation[1]?.stop(),this.scaleAnimation?.stop(),this.lastWheelTime=s;let i=this.map.scale;this.scaleAnimation=B({velocity:Math.log2(1+Math.abs(n[1])/200)/2,power:2,timeConstant:50,restDelta:.001,onUpdate:o=>{let a=Math.log2(i)-e[1]*o;this.scaleTo(2**a,[t.x,t.y])}})}onPinch(e){let{origin:t,da:n,initial:s,touches:i,timeStamp:o}=e;if(i!=2)return;this.lastPinchTime=o;let a=n[0]/s[0]*this.initialScale;this.velocityScale.add(a-this.map.scale),this.scaleTo(a,t)}onPinchEnd({origin:e}){let n=this.velocityScale.value>0?-1:1;this.initialScale=this.map.scale;let s=Math.log10(1+Math.abs(this.velocityScale.value))*50;this.scaleAnimation?.stop(),this.scaleAnimation=B({velocity:s,timeConstant:50,restDelta:.001,onUpdate:i=>{let o=Math.log2(this.initialScale)-n*i;this.scaleTo(2**o,e)}})}onDragStart(){this.offsetAnimation[0]?.stop(),this.offsetAnimation[1]?.stop(),this.scaleAnimation?.stop(),this.velocity[0].clear(),this.velocity[1].clear()}onDrag(e){let{pinching:t,wheeling:n,timeStamp:s,velocity:i,delta:o}=e;t||n||s-this.lastPinchTime<200||(this.velocity[0].add(i[0]),this.velocity[1].add(i[1]),this.setOffset([this.map.offset[0]+o[0],this.map.offset[1]+o[1]]))}async onDragEnd(e){let{direction:t,timeStamp:n,distance:s}=e;if(n-this.lastPinchTime<200)return;let i=[...this.map.offset],o=[this.velocity[0].value,this.velocity[1].value],a=Math.sqrt(o[0]**2+o[1]**2);a!=0&&(this.offsetAnimation[0]=B({velocity:a,power:200,timeConstant:200,onUpdate:c=>{this.setOffset([i[0]+t[0]*c*(o[0]/a),i[1]+t[1]*c*(o[1]/a)])}})),(s[0]>2||s[1]>2)&&(this.lastDragTime=n)}onClick({event:e}){if(e.timeStamp==this.lastDragTime)return;let t=200;if(e.timeStamp-this.lastClickTime<t){let n=this.map.scale;this.scaleAnimation?.stop(),this.scaleAnimation=B({velocity:1,power:1,timeConstant:100,restDelta:.001,onUpdate:s=>{let i=Math.log2(n)+s;this.scaleTo(2**i,[e.x,e.y])}})}else setTimeout(()=>{e.timeStamp==this.lastClickTime&&this.onClickTilemap([e.x,e.y])},t);this.lastClickTime=e.timeStamp}onClickTilemap(e){let t=this.map.findMarker(e);if(t){t?.[0].options.onClick?.(t[1]),this.map.options.onClick?.({target:t[0],index:t[1]});return}this.map.options.onClick?.()}limitScale(e){let{minZoom:t,options:n}=this.map,s=Math.log2(e);return s=Math.max(Math.min(s,n.maxZoom),t),2**s}scaleTo(e,t){let{offset:n,scale:s}=this.map;e=this.limitScale(e);let i=(e-s)/s;this.map.scale=e,this.setOffset([n[0]-(t[0]-n[0])*i,n[1]-(t[1]-n[1])*i])}setOffset(e){let{size:t,options:n,offset:s,scale:i}=this.map,o=[t[0]-n.size[0]*i,t[1]-n.size[1]*i];s[0]=Math.min(Math.max(e[0],o[0]),0),s[1]=Math.min(Math.max(e[1],o[1]),0),this.map.draw(),this.map.options.onMove?.()}};var k=class{},Ge=class{element;canvas;canvas2d;options;offset=[0,0];scale=0;minZoom=0;size=[0,0];tileLayers=new Set;markerLayers=new Set;domLayers=new Set;imageLayers=new Set;gesture;lastDrawTime=0;constructor(e){this.options={...e,tileOffset:e.tileOffset??[0,0],maxZoom:e.maxZoom??0},typeof e.element=="string"?this.element=document.querySelector(e.element):this.element=e.element,this.element.style.touchAction="none",this.canvas=document.createElement("canvas"),this.element.appendChild(this.canvas),this.canvas2d=this.canvas.getContext("2d"),this.gesture=new Ve(this),new ResizeObserver(([n])=>{let{width:s,height:i}=n.contentRect;setTimeout(()=>this.resize(s,i),0)}).observe(this.element),this.element.addEventListener("mousemove",({clientX:n,clientY:s})=>{let i=this.findMarker([n,s]);if(i){i?.[0].options.onMouseMove?.(i[1]),this.options.onMouseMove?.({target:i[0],index:i[1]});return}this.options.onMouseMove?.()}),this.domLayers.clear=new Proxy(this.domLayers.clear,{apply:(n,s)=>{for(let i of s.values())this.element.removeChild(i.element);return n.apply(s)}}),this.domLayers.delete=new Proxy(this.domLayers.delete,{apply:(n,s,i)=>(this.element.removeChild(i[0].element),n.apply(s,i))}),this.domLayers.add=new Proxy(this.domLayers.add,{apply:(n,s,i)=>(this.element.appendChild(i[0].element),this.draw(),n.apply(s,i))})}findMarker(e){let t=Array.from(this.markerLayers).reverse();for(let n of t.filter(s=>s.options.clickable)){let{image:s,items:i,anchor:o}=n.options,a=[s.width,s.height];a[0]/=devicePixelRatio,a[1]/=devicePixelRatio;for(let c=i.length-1;c>=0;c-=1){let[u,l]=this.toCanvasPositionWithOffset([i[c].x,i[c].y]),p=[a[0]*o[0],a[1]*o[1]];if(e[0]>u-p[0]&&e[0]<u+(a[0]-p[0])&&e[1]>l-p[1]&&e[1]<l+(a[0]-p[0]))return[n,c]}}}toCanvasPositionWithOffset(e){let{offset:t}=this,[n,s]=this.toCanvasPosition(e);return[n+t[0],s+t[1]]}toCanvasPosition([e,t]){let[n,s]=this.mapPointOffset;return[(e+n)*this.scale,(t+s)*this.scale]}overlaps(e,t){return e[0]+t[0]>-this.offset[0]&&e[0]<this.size[0]-this.offset[0]&&e[1]+t[1]>-this.offset[1]&&e[1]<this.size[1]-this.offset[1]}get mapPointOffset(){let{origin:e,tileOffset:t}=this.options;return[e[0]-t[0],e[1]-t[1]]}resize(e,t){this.canvas.width=e*devicePixelRatio,this.canvas.height=t*devicePixelRatio,this.canvas.style.width=`${e}px`,this.canvas.style.height=`${t}px`,this.size=[e,t];let n=Math.max(this.size[0]/this.options.size[0],this.size[1]/this.options.size[1]),s=Math.log2(n);this.scale?this.minZoom!=s?(this.minZoom=s,this.gesture.scaleTo(this.scale,[this.size[0]/2,this.size[1]/2])):this.draw():(this.minZoom=s,this.scale=this.gesture.limitScale(n),this.draw())}draw(){let e=Date.now();e!=this.lastDrawTime&&(requestAnimationFrame(()=>{let{canvas2d:t,canvas:n,offset:s}=this;t.setTransform(devicePixelRatio,0,0,devicePixelRatio,0,0),t.clearRect(0,0,n.width,n.height),t.translate(s[0],s[1]);for(let i of this.tileLayers)i.draw();for(let i of this.imageLayers)i.draw();for(let i of this.markerLayers)i.draw();for(let i of this.domLayers)i.draw()}),this.lastDrawTime=e)}};function $(r){return Math.ceil(parseFloat(r.toFixed(3)))}function Hs(r){return function(...e){var t=e.pop();return r.call(this,e,t)}}var Ys=typeof queueMicrotask=="function"&&queueMicrotask,Wr=typeof setImmediate=="function"&&setImmediate,qr=typeof process=="object"&&typeof process.nextTick=="function";function Zr(r){setTimeout(r,0)}function Xr(r){return(e,...t)=>r(()=>e(...t))}var ve;Ys?ve=queueMicrotask:Wr?ve=setImmediate:qr?ve=process.nextTick:ve=Zr;var be=Xr(ve);function Ks(r){return Lt(r)?function(...e){let t=e.pop(),n=r.apply(this,e);return Fr(n,t)}:Hs(function(e,t){var n;try{n=r.apply(this,e)}catch(s){return t(s)}if(n&&typeof n.then=="function")return Fr(n,t);t(null,n)})}function Fr(r,e){return r.then(t=>{Vr(e,null,t)},t=>{Vr(e,t&&t.message?t:new Error(t))})}function Vr(r,e,t){try{r(e,t)}catch(n){be(s=>{throw s},n)}}function Lt(r){return r[Symbol.toStringTag]==="AsyncFunction"}function Ws(r){return r[Symbol.toStringTag]==="AsyncGenerator"}function qs(r){return typeof r[Symbol.asyncIterator]=="function"}function T(r){if(typeof r!="function")throw new Error("expected a function");return Lt(r)?Ks(r):r}function x(r,e=r.length){if(!e)throw new Error("arity is undefined");function t(...n){return typeof n[e-1]=="function"?r.apply(this,n):new Promise((s,i)=>{n[e-1]=(o,...a)=>{if(o)return i(o);s(a.length>1?a:a[0])},r.apply(this,n)})}return t}function Qr(r){return function(t,...n){return x(function(i){var o=this;return r(t,(a,c)=>{T(a).apply(o,n.concat(c))},i)})}}function At(r,e,t,n){e=e||[];var s=[],i=0,o=T(t);return r(e,(a,c,u)=>{var l=i++;o(a,(p,d)=>{s[l]=d,u(p)})},a=>{n(a,s)})}function Ye(r){return r&&typeof r.length=="number"&&r.length>=0&&r.length%1===0}var Ke={};function ie(r){function e(...t){if(r!==null){var n=r;r=null,n.apply(this,t)}}return Object.assign(e,r),e}function Zs(r){return r[Symbol.iterator]&&r[Symbol.iterator]()}function Xs(r){var e=-1,t=r.length;return function(){return++e<t?{value:r[e],key:e}:null}}function Qs(r){var e=-1;return function(){var n=r.next();return n.done?null:(e++,{value:n.value,key:e})}}function Js(r){var e=r?Object.keys(r):[],t=-1,n=e.length;return function s(){var i=e[++t];return i==="__proto__"?s():t<n?{value:r[i],key:i}:null}}function ei(r){if(Ye(r))return Xs(r);var e=Zs(r);return e?Qs(e):Js(r)}function H(r){return function(...e){if(r===null)throw new Error("Callback was already called.");var t=r;r=null,t.apply(this,e)}}function Gr(r,e,t,n){let s=!1,i=!1,o=!1,a=0,c=0;function u(){a>=e||o||s||(o=!0,r.next().then(({value:d,done:b})=>{if(!(i||s)){if(o=!1,b){s=!0,a<=0&&n(null);return}a++,t(d,c,l),c++,u()}}).catch(p))}function l(d,b){if(a-=1,!i){if(d)return p(d);if(d===!1){s=!0,i=!0;return}if(b===Ke||s&&a<=0)return s=!0,n(null);u()}}function p(d){i||(o=!1,s=!0,n(d))}u()}var j=r=>(e,t,n)=>{if(n=ie(n),r<=0)throw new RangeError("concurrency limit cannot be less than 1");if(!e)return n(null);if(Ws(e))return Gr(e,r,t,n);if(qs(e))return Gr(e[Symbol.asyncIterator](),r,t,n);var s=ei(e),i=!1,o=!1,a=0,c=!1;function u(p,d){if(!o)if(a-=1,p)i=!0,n(p);else if(p===!1)i=!0,o=!0;else{if(d===Ke||i&&a<=0)return i=!0,n(null);c||l()}}function l(){for(c=!0;a<r&&!i;){var p=s();if(p===null){i=!0,a<=0&&n(null);return}a+=1,t(p.value,p.key,H(u))}c=!1}l()};function ti(r,e,t,n){return j(e)(r,T(t),n)}var Jr=x(ti,4);function ri(r,e,t){t=ie(t);var n=0,s=0,{length:i}=r,o=!1;i===0&&t(null);function a(c,u){c===!1&&(o=!0),o!==!0&&(c?t(c):(++s===i||u===Ke)&&t(null))}for(;n<i;n++)e(r[n],n,H(a))}function ni(r,e,t){return Jr(r,1/0,e,t)}function si(r,e,t){var n=Ye(r)?ri:ni;return n(r,T(e),t)}var Y=x(si,3);function ii(r,e,t){return At(Y,r,e,t)}var en=x(ii,3),wc=Qr(en);function oi(r,e,t){return Jr(r,1,e,t)}var oe=x(oi,3);function ai(r,e,t){return At(oe,r,e,t)}var ci=x(ai,3),xc=Qr(ci),Sc=Symbol("promiseCallback");var It=class{constructor(){this.head=this.tail=null,this.length=0}removeLink(e){return e.prev?e.prev.next=e.next:this.head=e.next,e.next?e.next.prev=e.prev:this.tail=e.prev,e.prev=e.next=null,this.length-=1,e}empty(){for(;this.head;)this.shift();return this}insertAfter(e,t){t.prev=e,t.next=e.next,e.next?e.next.prev=t:this.tail=t,e.next=t,this.length+=1}insertBefore(e,t){t.prev=e.prev,t.next=e,e.prev?e.prev.next=t:this.head=t,e.prev=t,this.length+=1}unshift(e){this.head?this.insertBefore(this.head,e):Hr(this,e)}push(e){this.tail?this.insertAfter(this.tail,e):Hr(this,e)}shift(){return this.head&&this.removeLink(this.head)}pop(){return this.tail&&this.removeLink(this.tail)}toArray(){return[...this]}*[Symbol.iterator](){for(var e=this.head;e;)yield e.data,e=e.next}remove(e){for(var t=this.head;t;){var{next:n}=t;e(t)&&this.removeLink(t),t=n}return this}};function Hr(r,e){r.length=1,r.head=r.tail=e}function ui(r,e,t){if(e==null)e=1;else if(e===0)throw new RangeError("Concurrency must not be zero");var n=T(r),s=0,i=[];let o={error:[],drain:[],saturated:[],unsaturated:[],empty:[]};function a(f,h){o[f].push(h)}function c(f,h){let y=(...w)=>{u(f,y),h(...w)};o[f].push(y)}function u(f,h){if(!f)return Object.keys(o).forEach(y=>o[y]=[]);if(!h)return o[f]=[];o[f]=o[f].filter(y=>y!==h)}function l(f,...h){o[f].forEach(y=>y(...h))}var p=!1;function d(f,h,y,w){if(w!=null&&typeof w!="function")throw new Error("task callback must be a function");m.started=!0;var S,M;function D(K,...F){if(K)return y?M(K):S();if(F.length<=1)return S(F[0]);S(F)}var P=m._createTaskItem(f,y?D:w||D);if(h?m._tasks.unshift(P):m._tasks.push(P),p||(p=!0,be(()=>{p=!1,m.process()})),y||!w)return new Promise((K,F)=>{S=K,M=F})}function b(f){return function(h,...y){s-=1;for(var w=0,S=f.length;w<S;w++){var M=f[w],D=i.indexOf(M);D===0?i.shift():D>0&&i.splice(D,1),M.callback(h,...y),h!=null&&l("error",h,M.data)}s<=m.concurrency-m.buffer&&l("unsaturated"),m.idle()&&l("drain"),m.process()}}function g(f){return f.length===0&&m.idle()?(be(()=>l("drain")),!0):!1}let v=f=>h=>{if(!h)return new Promise((y,w)=>{c(f,(S,M)=>{if(S)return w(S);y(M)})});u(f),a(f,h)};var _=!1,m={_tasks:new It,_createTaskItem(f,h){return{data:f,callback:h}},*[Symbol.iterator](){yield*m._tasks[Symbol.iterator]()},concurrency:e,payload:t,buffer:e/4,started:!1,paused:!1,push(f,h){return Array.isArray(f)?g(f)?void 0:f.map(y=>d(y,!1,!1,h)):d(f,!1,!1,h)},pushAsync(f,h){return Array.isArray(f)?g(f)?void 0:f.map(y=>d(y,!1,!0,h)):d(f,!1,!0,h)},kill(){u(),m._tasks.empty()},unshift(f,h){return Array.isArray(f)?g(f)?void 0:f.map(y=>d(y,!0,!1,h)):d(f,!0,!1,h)},unshiftAsync(f,h){return Array.isArray(f)?g(f)?void 0:f.map(y=>d(y,!0,!0,h)):d(f,!0,!0,h)},remove(f){m._tasks.remove(f)},process(){if(!_){for(_=!0;!m.paused&&s<m.concurrency&&m._tasks.length;){var f=[],h=[],y=m._tasks.length;m.payload&&(y=Math.min(y,m.payload));for(var w=0;w<y;w++){var S=m._tasks.shift();f.push(S),i.push(S),h.push(S.data)}s+=1,m._tasks.length===0&&l("empty"),s===m.concurrency&&l("saturated");var M=H(b(f));n(h,M)}_=!1}},length(){return m._tasks.length},running(){return s},workersList(){return i},idle(){return m._tasks.length+s===0},pause(){m.paused=!0},resume(){m.paused!==!1&&(m.paused=!1,be(m.process))}};return Object.defineProperties(m,{saturated:{writable:!1,value:v("saturated")},unsaturated:{writable:!1,value:v("unsaturated")},empty:{writable:!1,value:v("empty")},drain:{writable:!1,value:v("drain")},error:{writable:!1,value:v("error")}}),m}function li(r,e,t,n){n=ie(n);var s=T(t);return oe(r,(i,o,a)=>{s(e,i,(c,u)=>{e=u,a(c)})},i=>n(i,e))}var Oc=x(li,4);function fi(r,e,t,n){return At(j(e),r,t,n)}var tn=x(fi,4);function hi(r,e,t,n){var s=T(t);return tn(r,e,(i,o)=>{s(i,(a,...c)=>a?o(a):o(a,c))},(i,o)=>{for(var a=[],c=0;c<o.length;c++)o[c]&&(a=a.concat(...o[c]));return n(i,a)})}var rn=x(hi,4);function pi(r,e,t){return rn(r,1/0,e,t)}var Tc=x(pi,3);function mi(r,e,t){return rn(r,1,e,t)}var Ec=x(mi,3);function N(r,e){return(t,n,s,i)=>{var o=!1,a;let c=T(s);t(n,(u,l,p)=>{c(u,(d,b)=>{if(d||d===!1)return p(d);if(r(b)&&!a)return o=!0,a=e(!0,u),p(null,Ke);p()})},u=>{if(u)return i(u);i(null,o?a:e(!1))})}}function di(r,e,t){return N(n=>n,(n,s)=>s)(Y,r,e,t)}var Mc=x(di,3);function gi(r,e,t,n){return N(s=>s,(s,i)=>i)(j(e),r,t,n)}var Ic=x(gi,4);function yi(r,e,t){return N(n=>n,(n,s)=>s)(j(1),r,e,t)}var Lc=x(yi,3);function nn(r){return(e,...t)=>T(e)(...t,(n,...s)=>{typeof console=="object"&&(n?console.error&&console.error(n):console[r]&&s.forEach(i=>console[r](i)))})}var Ac=nn("dir");function vi(r,e,t){t=H(t);var n=T(r),s=T(e),i;function o(c,...u){if(c)return t(c);c!==!1&&(i=u,s(...u,a))}function a(c,u){if(c)return t(c);if(c!==!1){if(!u)return t(null,...i);n(o)}}return a(null,!0)}var Dc=x(vi,3);function sn(r){return(e,t,n)=>r(e,n)}function bi(r,e,t){return Y(r,sn(T(e)),t)}var Pc=x(bi,3);function _i(r,e,t,n){return j(e)(r,sn(T(t)),n)}var wi=x(_i,4);function xi(r,e,t){return wi(r,1,e,t)}var Si=x(xi,3);function Oi(r){return Lt(r)?r:function(...e){var t=e.pop(),n=!0;e.push((...s)=>{n?be(()=>t(...s)):t(...s)}),r.apply(this,e),n=!1}}function Ti(r,e,t){return N(n=>!n,n=>!n)(Y,r,e,t)}var Cc=x(Ti,3);function Ei(r,e,t,n){return N(s=>!s,s=>!s)(j(e),r,t,n)}var kc=x(Ei,4);function Mi(r,e,t){return N(n=>!n,n=>!n)(oe,r,e,t)}var jc=x(Mi,3);function Ii(r,e,t,n){var s=new Array(e.length);r(e,(i,o,a)=>{t(i,(c,u)=>{s[o]=!!u,a(c)})},i=>{if(i)return n(i);for(var o=[],a=0;a<e.length;a++)s[a]&&o.push(e[a]);n(null,o)})}function Li(r,e,t,n){var s=[];r(e,(i,o,a)=>{t(i,(c,u)=>{if(c)return a(c);u&&s.push({index:o,value:i}),a(c)})},i=>{if(i)return n(i);n(null,s.sort((o,a)=>o.index-a.index).map(o=>o.value))})}function We(r,e,t,n){var s=Ye(e)?Ii:Li;return s(r,e,T(t),n)}function Ai(r,e,t){return We(Y,r,e,t)}var Rc=x(Ai,3);function Di(r,e,t,n){return We(j(e),r,t,n)}var Bc=x(Di,4);function Pi(r,e,t){return We(oe,r,e,t)}var $c=x(Pi,3);function Ci(r,e){var t=H(e),n=T(Oi(r));function s(i){if(i)return t(i);i!==!1&&n(s)}return s()}var Nc=x(Ci,2);function ki(r,e,t,n){var s=T(t);return tn(r,e,(i,o)=>{s(i,(a,c)=>a?o(a):o(a,{key:c,val:i}))},(i,o)=>{for(var a={},{hasOwnProperty:c}=Object.prototype,u=0;u<o.length;u++)if(o[u]){var{key:l}=o[u],{val:p}=o[u];c.call(a,l)?a[l].push(p):a[l]=[p]}return n(i,a)})}var Uc=x(ki,4);var zc=nn("log");function ji(r,e,t,n){n=ie(n);var s={},i=T(t);return j(e)(r,(o,a,c)=>{i(o,a,(u,l)=>{if(u)return c(u);s[a]=l,c(u)})},o=>n(o,s))}var Fc=x(ji,4);var He;qr?He=process.nextTick:Wr?He=setImmediate:He=Zr;var Vc=Xr(He),Gc=x((r,e,t)=>{var n=Ye(e)?[]:{};r(e,(s,i,o)=>{T(s)((a,...c)=>{c.length<2&&([c]=c),n[i]=c,o(a)})},s=>t(s,n))},3);function on(r,e){var t=T(r);return ui((n,s)=>{t(n[0],s)},e,1)}var Yr=class{constructor(){this.heap=[],this.pushCount=Number.MIN_SAFE_INTEGER}get length(){return this.heap.length}empty(){return this.heap=[],this}percUp(e){let t;for(;e>0&&Mt(this.heap[e],this.heap[t=Kr(e)]);){let n=this.heap[e];this.heap[e]=this.heap[t],this.heap[t]=n,e=t}}percDown(e){let t;for(;(t=Ri(e))<this.heap.length&&(t+1<this.heap.length&&Mt(this.heap[t+1],this.heap[t])&&(t=t+1),!Mt(this.heap[e],this.heap[t]));){let n=this.heap[e];this.heap[e]=this.heap[t],this.heap[t]=n,e=t}}push(e){e.pushCount=++this.pushCount,this.heap.push(e),this.percUp(this.heap.length-1)}unshift(e){return this.heap.push(e)}shift(){let[e]=this.heap;return this.heap[0]=this.heap[this.heap.length-1],this.heap.pop(),this.percDown(0),e}toArray(){return[...this]}*[Symbol.iterator](){for(let e=0;e<this.heap.length;e++)yield this.heap[e].data}remove(e){let t=0;for(let n=0;n<this.heap.length;n++)e(this.heap[n])||(this.heap[t]=this.heap[n],t++);this.heap.splice(t);for(let n=Kr(this.heap.length-1);n>=0;n--)this.percDown(n);return this}};function Ri(r){return(r<<1)+1}function Kr(r){return(r+1>>1)-1}function Mt(r,e){return r.priority!==e.priority?r.priority<e.priority:r.pushCount<e.pushCount}function Bi(r,e){if(e=ie(e),!Array.isArray(r))return e(new TypeError("First argument to race must be an array of functions"));if(!r.length)return e();for(var t=0,n=r.length;t<n;t++)T(r[t])(e)}var Hc=x(Bi,2);function Dt(r,e,t,n){let s=T(t);return We(r,e,(i,o)=>{s(i,(a,c)=>{o(a,!c)})},n)}function $i(r,e,t){return Dt(Y,r,e,t)}var Yc=x($i,3);function Ni(r,e,t,n){return Dt(j(e),r,t,n)}var Kc=x(Ni,4);function Ui(r,e,t){return Dt(oe,r,e,t)}var Wc=x(Ui,3);function zi(r,e,t){return N(Boolean,n=>n)(Y,r,e,t)}var qc=x(zi,3);function Fi(r,e,t,n){return N(Boolean,s=>s)(j(e),r,t,n)}var Zc=x(Fi,4);function Vi(r,e,t){return N(Boolean,n=>n)(oe,r,e,t)}var Xc=x(Vi,3);function Gi(r,e,t){var n=T(e);return en(r,(i,o)=>{n(i,(a,c)=>{if(a)return o(a);o(a,{value:i,criteria:c})})},(i,o)=>{if(i)return t(i);t(null,o.sort(s).map(a=>a.value))});function s(i,o){var a=i.criteria,c=o.criteria;return a<c?-1:a>c?1:0}}var Qc=x(Gi,3);function Hi(r,e){var t=null,n;return Si(r,(s,i)=>{T(s)((o,...a)=>{if(o===!1)return i(o);a.length<2?[n]=a:n=a,t=o,i(o?null:{})})},()=>e(t,n))}var Jc=x(Hi);function Yi(r,e,t){t=H(t);var n=T(e),s=T(r),i=[];function o(c,...u){if(c)return t(c);i=u,c!==!1&&s(a)}function a(c,u){if(c)return t(c);if(c!==!1){if(!u)return t(null,...i);n(o)}}return s(a)}var eu=x(Yi,3);function Ki(r,e){if(e=ie(e),!Array.isArray(r))return e(new Error("First argument to waterfall must be an array of functions"));if(!r.length)return e();var t=0;function n(i){var o=T(r[t++]);o(...i,H(s))}function s(i,...o){if(i!==!1){if(i||t===r.length)return e(i,...o);n(o)}}n([])}var tu=x(Ki);var qe=class extends k{map;options;tiles={};images={};queue;constructor(e,t){super(),this.map=e,this.options={...t,tileSize:t.tileSize??256};let{size:n,tileOffset:s}=e.options,{minZoom:i,maxZoom:o,tileSize:a}=this.options;for(let c=i;c<=o;c+=1){let u=a*2**(o-c),l=$(n[1]/u),p=$(n[0]/u),d=[Math.floor(s[0]/u),Math.floor(s[1]/u)],b=[];for(let g=0;g<l;g+=1){b[g]=[];for(let v=0;v<p;v+=1){let _=t.getTileUrl(v+d[0],g+d[1],c);b[g][v]=_}}this.tiles[c]=b}this.queue=on((c,u)=>{if(this.images[c])return u();let l=new Image;l.crossOrigin=t.crossOrigin,l.src=c,l.addEventListener("load",()=>{this.images[c]=l,this.map.draw(),u()})});for(let c of this.tiles[i])for(let u of c)this.fetch(u)}fetch(e){this.queue.push(e)}draw(){let{minZoom:e,maxZoom:t}=this.options;this.drawTiles(e);let n=t+Math.log2(this.map.scale);n=$(Math.min(Math.max(n,e),t)),n>e&&this.drawTiles(n)}drawTiles(e){let t=this.tiles[e],{scale:n,offset:s,size:i,options:o}=this.map,a=this.options.tileSize*2**(this.options.maxZoom-e),c=a*n,u=o.size[0]%a*n,l=Math.floor(-s[0]/c),p=$((i[0]-s[0]+u)/c),d=Math.floor(-s[1]/c),b=$((i[1]-s[1])/c);for(let g=d;g<b;g+=1)for(let v=l;v<p;v+=1){let _=t[g][v],m=this.images[t[g][v]];m?this.map.canvas2d.drawImage(m,c*v-u,c*g,c,c):this.fetch(_)}}};var _e=class extends k{map;options;constructor(e,t){super(),this.map=e,this.options={...t,anchor:t.anchor??[.5,1],clickable:t.clickable??!0}}draw(){let{items:e,image:t,anchor:n}=this.options,{canvas2d:s}=this.map,i=[t.width,t.height];i[0]/=devicePixelRatio,i[1]/=devicePixelRatio;for(let o of e){let[a,c]=this.map.toCanvasPosition([o.x,o.y]);a-=i[0]*n[0],c-=i[1]*n[1],this.map.overlaps([a,c],i)&&s.drawImage(t,a,c,i[0],i[1])}}};var Ze=class extends k{map;options;element;constructor(e,t){super(),this.map=e,this.options=t,this.element=document.createElement("div"),this.element.style.position="absolute",this.element.style.top="0",this.element.style.left="0",this.element.appendChild(t.element),this.element.addEventListener("click",s=>{s.target!=this.element&&s.stopPropagation()}),new ResizeObserver(([s])=>{let{blockSize:i,inlineSize:o}=s.borderBoxSize[0];this.element.style.width=`${o}px`,this.element.style.height=`${i}px`}).observe(t.element)}draw(){let[e,t]=this.map.toCanvasPositionWithOffset(this.options.position);this.element.style.transform=`translate(${e}px, ${t}px)`}};var we=class extends k{map;options;images={};minZoom=0;constructor(e,t){super(),this.map=e,this.options=t,this.init()}async init(){this.minZoom=$(this.map.minZoom);let e=this.options.image;for(let t=0;t>=this.minZoom;t-=1)e=this.downscaleImage(e),this.images[t]=e}downscaleImage(e){let t=document.createElement("canvas"),n=t.getContext("2d");return t.width=e.width/2,t.height=e.height/2,t.width==0||t.height==0?e:(n.drawImage(e,0,0,t.width,t.height),t)}draw(){let{canvas2d:e,scale:t}=this.map,n=$(Math.log2(t));n=Math.max(Math.min(n,0),this.minZoom);let s=this.images[n]??this.options.image,{bounds:i}=this.options,[o,a]=this.map.mapPointOffset,c=(o+i[0][0])*t,u=(a+i[0][1])*t,l=(o+i[1][0])*t,p=(a+i[1][1])*t,d=[l-c,p-u];this.map.overlaps([c,u],d)&&e.drawImage(s,c,u,d[0],d[1])}};var an="";async function Pt(r,e={}){return(await(await fetch(`https://cloud.yuanshen.site/api/${r}`,{method:"post",body:JSON.stringify(e),headers:{"content-type":"application/json",authorization:`Bearer ${an}`}})).json()).data}async function cn(){an=(await(await fetch("https://cloud.yuanshen.site/oauth/token?scope=all&grant_type=client_credentials",{method:"post",headers:{authorization:"Basic Y2xpZW50OnNlY3JldA=="}})).json()).access_token}var un=[["\u8BF8\u6CD5\u4E1B\u6797-\u5E95\u56FE1",{imageUrl:"https://assets.yuanshen.site/overlay/YL/1.png",imageBounds:[[-6299+1427,-2190+1353],[-6299+1427+404,-2190+1353+504]]}],["\u8BF8\u6CD5\u4E1B\u6797-\u5E95\u56FE2",{imageUrl:"https://assets.yuanshen.site/overlay/YL/2.png",imageBounds:[[-6299+1299,-2190+2040],[-6299+1299+648,-2190+2040+570]]}],["\u8BF8\u6CD5\u4E1B\u6797-\u5E95\u56FE3",{imageUrl:"https://assets.yuanshen.site/overlay/YL/3.png",imageBounds:[[-6299+2199,-2190+1671],[-6299+2199+398,-2190+1671+306]]}],["\u8BF8\u6CD5\u4E1B\u6797-\u5E95\u56FE4",{imageUrl:"https://assets.yuanshen.site/overlay/YL/4.png",imageBounds:[[-6299+2177,-2190+2168],[-6299+2177+570,-2190+2168+515]]}],["\u8BF8\u6CD5\u4E1B\u6797-\u5E95\u56FE5",{imageUrl:"https://assets.yuanshen.site/overlay/YL/5.png",imageBounds:[[-6299+2734,-2190+937],[-6299+2734+433,-2190+937+660]]}],["\u8BF8\u6CD5\u4E1B\u6797-\u5E95\u56FE6",{imageUrl:"https://assets.yuanshen.site/overlay/YL/6.png",imageBounds:[[-6299+3323,-2190+507],[-6299+3323+443,-2190+507+377]]}],["\u8BF8\u6CD5\u4E1B\u6797-\u5E95\u56FE7",{imageUrl:"https://assets.yuanshen.site/overlay/YL/7.png",imageBounds:[[-6299+3426,-2190+924],[-6299+3426+278,-2190+924+360]]}],["\u8BF8\u6CD5\u4E1B\u6797-\u5E95\u56FE8",{imageUrl:"https://assets.yuanshen.site/overlay/YL/8.png",imageBounds:[[-6299+3796,-2190+1024],[-6299+3796+344,-2190+1024+393]]}],["\u8BF8\u6CD5\u4E1B\u6797-\u5E95\u56FE9",{imageUrl:"https://assets.yuanshen.site/overlay/YL/9.png",imageBounds:[[-6299+3563,-2190+1604],[-6299+3563+443,-2190+1604+799]]}],["\u8BF8\u6CD5\u4E1B\u6797-\u5E95\u56FE10",{imageUrl:"https://assets.yuanshen.site/overlay/YL/10.png",imageBounds:[[-6299+3787,-2190+2710],[-6299+3787+378,-2190+2710+560]]}],["\u8BF8\u6CD5\u4E1B\u6797-\u5E95\u56FE11",{imageUrl:"https://assets.yuanshen.site/overlay/YL/11.png",imageBounds:[[-6299+3086,-2190+3297],[-6299+3086+521,-2190+3297+433]]}],["\u8BF8\u6CD5\u4E1B\u6797-\u5E95\u56FE12",{imageUrl:"https://assets.yuanshen.site/overlay/YL/12.png",imageBounds:[[-6299+1887,-2190+3637],[-6299+1887+740,-2190+3637+346]]}],["\u5927\u8D64\u6C99\u6D77-\u5E95\u56FE1",{imageUrl:"https://assets.yuanshen.site/overlay/SM/\u56FA\u5B9A\u5E95\u56FE1.png",imageBounds:[[-7664+142,540+1183],[-7664+142+1119,540+1183+1351]]}],["\u5927\u8D64\u6C99\u6D77-\u5E95\u56FE2",{imageUrl:"https://assets.yuanshen.site/overlay/SM/\u56FA\u5B9A\u5E95\u56FE2.png",imageBounds:[[-7664+756,540+2256],[-7664+756+372,540+2256+105]]}],["\u5927\u8D64\u6C99\u6D77-\u5E95\u56FE3",{imageUrl:"https://assets.yuanshen.site/overlay/SM/\u56FA\u5B9A\u5E95\u56FE3.png",imageBounds:[[-7664+2062,540+303],[-7664+2062+152,540+303+132]]}],["\u5927\u8D64\u6C99\u6D77-\u5E95\u56FE4",{imageUrl:"https://assets.yuanshen.site/overlay/SM/\u56FA\u5B9A\u5E95\u56FE4.png",imageBounds:[[-7664+2072,540+796],[-7664+2072+160,540+796+178]]}],["\u5927\u8D64\u6C99\u6D77-\u5E95\u56FE5",{imageUrl:"https://assets.yuanshen.site/overlay/SM/\u56FA\u5B9A\u5E95\u56FE5.png",imageBounds:[[-7664+1948,540+1483],[-7664+1948+293,540+1483+465]]}],["\u5927\u8D64\u6C99\u6D77-\u5E95\u56FE6",{imageUrl:"https://assets.yuanshen.site/overlay/SM/\u56FA\u5B9A\u5E95\u56FE6.png",imageBounds:[[-7664+2254,540+1370],[-7664+2254+332,540+1370+271]]}],["\u5927\u8D64\u6C99\u6D77-\u5E95\u56FE7",{imageUrl:"https://assets.yuanshen.site/overlay/SM/\u56FA\u5B9A\u5E95\u56FE7.png",imageBounds:[[-7664+2708,540+1656],[-7664+2708+398,540+1656+365]]}],["\u5927\u8D64\u6C99\u6D77-\u5E95\u56FE8",{imageUrl:"https://assets.yuanshen.site/overlay/SM/\u56FA\u5B9A\u5E95\u56FE8.png",imageBounds:[[-7664+1608,540+2316],[-7664+1608+985,540+2316+693]]}]],ln=[["\u79D8\u4EEA1",[[-7664+1108,540+1682],[-7664+1108+460,540+1682+259]]],["\u79D8\u4EEA2",[[-7664+1129,540+1589],[-7664+1129+279,540+1589+325]]],["\u79D8\u4EEA3",[[-7664+1149,540+1629],[-7664+1149+305,540+1629+259]]],["\u738B\u96751",[[-7664+729,540+1729],[-7664+729+124,540+1729+85]]],["\u738B\u96752",[[-7664+696,540+1642],[-7664+696+372,540+1642+246]]],["\u738B\u96753",[[-7664+721,540+1702],[-7664+721+187,540+1702+166]]],["\u820D\u8EAB1",[[-7664+2250,540+1489],[-7664+2250+356,540+1489+432]]],["\u820D\u8EAB2",[[-7664+2152,540+1596],[-7664+2152+312,540+1596+398]]],["\u820D\u8EAB3",[[-7664+2276,540+1649],[-7664+2276+324,540+1649+332]]],["\u5723\u663E1",[[-7664+1834,540+509],[-7664+1834+567,540+509+212]]],["\u5723\u663E2",[[-7664+1809,540+502],[-7664+1809+592,540+502+226]]],["\u5723\u663E3",[[-7664+1822,540+509],[-7664+1822+579,540+509+219]]]],fn=[["\u8D64\u738B\u7684\u6C34\u6676\u676F",[[-7043,-284],[-7043+769,-284+902]]],["\u6C38\u6052\u7EFF\u6D32",[[-6793,-125],[-6793+698,-125+689]]],["\u9163\u4E50\u4E4B\u6BBF4",[[-6904,-494],[-6904+285,-494+279]]],["\u9163\u4E50\u4E4B\u6BBF3",[[-6997,-496],[-6997+347,-496+178]]],["\u9163\u4E50\u4E4B\u6BBF2",[[-6882,-548],[-6882+505,-548+514]]],["\u9163\u4E50\u4E4B\u6BBF1",[[-6972,-455],[-6972+270,-455+354]]],["\u5C45\u5C14\u57CE\u589F\xB7\u8D64\u738B\u795E\u6BBF3",[[-7317,1237],[-7317+581,1237+482]]],["\u5C45\u5C14\u57CE\u589F\xB7\u8D64\u738B\u795E\u6BBF2",[[-6886,1577],[-6886+130,1577+169]]],["\u5C45\u5C14\u57CE\u589F\xB7\u8D64\u738B\u795E\u6BBF1",[[-7341,1174],[-7341+583,1174+688]]],["\u541B\u738B\u4E4B\u6BBF3",[[-6368,145],[-6368+435,145+468]]],["\u541B\u738B\u4E4B\u6BBF2",[[-6089,139],[-6089+222,139+139]]],["\u541B\u738B\u4E4B\u6BBF1",[[-6310,138],[-6310+442,138+409]]],["\u6C99\u866B\u96A7\u90533",[[-5490,-25],[-5490+180,-25+290]]],["\u6C99\u866B\u96A7\u90532",[[-5517,-19],[-5517+275,-19+506]]],["\u6C99\u866B\u96A7\u90531",[[-5914,-61],[-5914+682,-61+814]]],["\u751F\u547D\u4E4B\u6BBF",[[-7612,2],[-7612+643,2+588]]],["\u4E94\u7EFF\u6D32",[[-6171,-730],[-6171+643,-730+390]]],["\u884C\u5BAB\u82B1\u56ED",[[-7219,-785],[-7219+507,-785+522]]],["\u9547\u7075\u76D1\u7262\u53CA\u5DE8\u4EBA\u5CE1\u8C37",[[-7186,502],[-7186+788,502+510]]]];async function Wi(){let r=[17408,16384],e=[3568,6286],t=[-5120,0],n=new Ge({element:"#tilemap",size:r,tileOffset:t,origin:e,maxZoom:.5});n.tileLayers.add(new qe(n,{minZoom:10,maxZoom:13,getTileUrl(b,g,v){return`https://assets.yuanshen.site/tiles_twt34/${v}/${b}_${g}.png`}})),await cn();let{record:s}=await Pt("icon/get/list",{size:1e3}),i=32*devicePixelRatio,o={};for(let b of s)o[b.name]=b.url;c(126),c(1242),c(1561),c(97),c(159);let a=new _e(n,{items:[],image:new Image});n.options.onClick=b=>{if(b){let{target:g,index:v}=b;if(g==a)return;let{image:_,items:m}=g.options,f=m[v];n.markerLayers.add(a),a.options.items[0]=f,a.options.image=u(_);let h=document.createElement("div");h.className="marker",h.innerHTML=`
        <div class="marker-title">${f.data.markerTitle}</div>
        <div class="marker-content">${f.data.content}</div>
        ${f.data.picture?`<img src="${f.data.picture}">`:""}
      `,n.domLayers.clear(),n.domLayers.add(new Ze(n,{element:h,position:[f.x,f.y]})),n.draw()}else n.markerLayers.delete(a),n.domLayers.clear(),n.draw()};async function c(b){let g=await Pt("marker/get/list_byinfo",{itemIdList:[b]}),v=new _e(n,{items:g.map(_=>{let[m,f]=_.position.split(",").map(h=>parseInt(h));return{x:m,y:f,data:_}}),image:l(o[g[0].itemList[0].iconTag])});n.markerLayers.add(v)}function u(b){let g=document.createElement("canvas"),v=g.getContext("2d");return g.width=b.width,g.height=b.height,v.drawImage(b,0,0),g}function l(b){let g=document.createElement("canvas"),v=g.getContext("2d"),_=new Image;return _.src=b,_.addEventListener("load",()=>{g.width=i,g.height=i;let m=i/2;v.arc(m,m,m,0,2*Math.PI),v.fillStyle="rgba(255, 255, 255, 0.5)",v.fill();let f=[_.width*devicePixelRatio,_.height*devicePixelRatio];_.width>_.height?f=[i,f[1]*i/f[0]]:f=[f[0]*i/f[1],i];let h=(i-f[0])/2,y=(i-f[1])/2;v.drawImage(_,h,y,f[0],f[1]),n.draw()}),g}async function p(){await new Promise(v=>setTimeout(v,100));let b=document.createElement("canvas"),g=b.getContext("2d");g.fillStyle="rgba(0, 0, 0, 0.68)",g.rect(0,0,b.width,b.height),g.fill(),n.imageLayers.add(new we(n,{image:b,bounds:[[-e[0]+t[0],-e[1]+t[1]],r]}));for(let[v,{imageUrl:_,imageBounds:m}]of un)d(_,m);for(let[v,_]of ln)d(`https://assets.yuanshen.site/overlay/SM/${v}.png`,_);for(let[v,_]of fn)d(`https://assets.yuanshen.site/overlay/${v}.png`,_)}function d(b,g){let v=new Image;v.src=b,v.addEventListener("load",()=>{n.imageLayers.add(new we(n,{image:v,bounds:g})),n.draw()})}}Wi();})();
